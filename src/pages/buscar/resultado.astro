---
import type Producto from "../../models/Product";

interface Props {
    productos: Producto[];
}
const apiUrl = import.meta.env.PUBLIC_API_URL;
const { productos } = Astro.props;

// FunciÃ³n para construir la URL completa de imagen
const getImageUrl = (url: unknown): string => {
    if (typeof url === "string") {
        return url.startsWith("http")
            ? url
            : `${apiUrl}${url}`;
    }
    return "/placeholder.jpg";
};
---

<div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 py-6">
    {productos.map(producto => {
        const imagen = producto.imagenes?.[0]?.url_imagen ?? null;
        const textoAlt = producto.imagenes?.[0]?.texto_alt_SEO ?? producto.nombre;
        const imageUrl = getImageUrl(imagen);

        return (
            <a
                href={`/productos/detalle?link=${encodeURIComponent(producto.link)}`}
                class="block bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition"
            >
                <img
                    src={imageUrl}
                    alt={textoAlt}
                    class="w-full h-36 sm:h-40 object-cover"
                />
                <div class="p-4">
                    <h3 class="text-lg font-semibold text-gray-900">{producto.titulo}</h3>
                    <p class="text-sm text-gray-600">{producto.subtitulo}</p>
                </div>
            </a>
        );
    })}
</div>