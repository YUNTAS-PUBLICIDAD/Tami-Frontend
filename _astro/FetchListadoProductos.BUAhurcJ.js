import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{c as k,g as _}from"./config.BZJ3FbET.js";import{R,r as s}from"./index.Be8AcK8B.js";const N="productos_cache",E=300*1e3,F=()=>{try{const o=localStorage.getItem(N);if(!o)return null;const{data:t,timestamp:c}=JSON.parse(o);return Date.now()-c>E?(localStorage.removeItem(N),null):t}catch{return null}},M=o=>{try{const t={data:o,timestamp:Date.now()};localStorage.setItem(N,JSON.stringify(t))}catch{}},O=k.apiUrl;function W(){const[o,t]=s.useState([]),[c,n]=s.useState(!0),[d,x]=s.useState(null),[m,f]=s.useState(!1),u=s.useRef(null),[g,b]=s.useState(""),[l,h]=s.useState(null),[I,A]=s.useState(!0),y=s.useCallback(async(a=!0)=>{try{if(u.current?.abort(),n(!0),x(null),f(!0),a){const r=F();if(r){t(r),n(!1),f(!1);return}}u.current=new AbortController;const i=await fetch(_(k.endpoints.productos.list),{signal:u.current.signal});if(!i.ok)throw new Error("Error al obtener productos");const w=(await i.json()).map(r=>({id:r.id,nombre:r.nombre,link:r.link,titulo:r.titulo,subtitulo:r.subtitulo,lema:r.lema,descripcion:r.descripcion,especificaciones:r.especificaciones||{},productos_relacionados:r.productos_relacionados||[],imagenes:Array.isArray(r.imagenes)?r.imagenes.map(p=>({url_imagen:p.url_imagen||p.url||"",texto_alt_SEO:p.texto_alt_SEO||p.alt||"",imageTitle:p.imageTitle||""})):[],stock:r.stock,precio:parseFloat(r.precio),seccion:r.seccion,createdAt:r.created_at}));M(w),t(w)}catch(i){i.name!=="AbortError"&&(console.error("Error cargando productos:",i),x("Error al cargar los productos. Por favor, intenta nuevamente."))}finally{n(!1),f(!1)}},[]);s.useEffect(()=>(y(),()=>u.current?.abort()),[y]);const v=s.useCallback(a=>["Negocio","Decoración","Maquinaria"].map(S=>({productosDeLaSeccion:a.filter(w=>w.seccion===S)})),[]),C=s.useMemo(()=>{let a=[...o];return g.trim()&&(a=a.filter(i=>i.nombre.toLowerCase().includes(g.toLowerCase()))),l&&(a=a.filter(i=>i.seccion===l)),a},[o,g,l]),D=s.useMemo(()=>v(C),[C,v]);return c?e.jsx($,{}):d?e.jsxs("section",{className:"w-full flex flex-col items-center justify-center py-16",children:[e.jsx("p",{className:"text-red-600 text-lg mb-4",children:d}),e.jsx("button",{onClick:()=>y(!1),disabled:m,className:`px-6 py-2 rounded-lg transition-colors ${m?"bg-gray-400 cursor-not-allowed":"bg-teal-600 hover:bg-teal-700 text-white"}`,children:m?"Cargando...":"Reintentar"})]}):e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 p-8",children:[e.jsx("aside",{className:"md:w-4/12 xl:w-3/12 hidden sm:block",children:e.jsxs("div",{className:"p-4 border rounded-xl shadow-[0_0_10px_rgba(0,0,0,0.25)] shadow-[#00B6FF] space-y-4",style:{borderColor:"#00B6FF"},children:[e.jsx("h1",{className:"uppercase text-[#009688] font-bold text-center text-3xl mb-2",style:{textDecoration:"underline",textUnderlineOffset:"6px"},children:"FILTROS"}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-[#009688] text-lg uppercase mb-1",children:"NOMBRE"}),e.jsx("input",{type:"text",value:g,onChange:a=>b(a.target.value),placeholder:"Buscar",className:"p-3 shadow rounded-lg w-full outline-none focus:ring-2 focus:ring-[#009688] text-[#009688] font-semibold bg-white mb-4",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.10)"}})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"font-bold text-[#009688] text-lg uppercase",children:"CATEGORIAS"}),e.jsx("span",{className:"text-[#009688] text-xl font-bold",children:"▼"})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("button",{type:"button",onClick:()=>h(l==="Negocio"?null:"Negocio"),className:`py-3 px-0 rounded-xl text-lg font-bold uppercase shadow-md w-full transition-all duration-150 active:scale-95 hover:opacity-90 hover:shadow-lg ${l==="Negocio"?"ring-2 ring-white":""}`,style:{background:"#00B6FF",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"NEGOCIO"}),e.jsx("button",{type:"button",onClick:()=>h(l==="Maquinaria"?null:"Maquinaria"),className:`py-3 px-0 rounded-xl text-lg font-bold uppercase shadow-md w-full transition-all duration-150 active:scale-95 hover:opacity-90 hover:shadow-lg ${l==="Maquinaria"?"ring-2 ring-white":""}`,style:{background:"#04B088",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"MAQUINARIA"}),e.jsx("button",{type:"button",onClick:()=>h(l==="Decoración"?null:"Decoración"),className:`py-3 px-0 rounded-xl text-lg font-bold uppercase shadow-md w-full transition-all duration-150 active:scale-95 hover:opacity-90 hover:shadow-lg ${l==="Decoración"?"ring-2 ring-white":""}`,style:{background:"#5D39FB",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"DECORACIÓN"})]})]}),e.jsx("div",{className:"flex justify-center pt-8",children:e.jsx("button",{onClick:()=>{b(""),h(null)},className:"py-3 px-6 uppercase bg-white text-[#009688] font-bold text-lg rounded-xl shadow-md transition-all duration-150 hover:bg-[#e0f7fa] hover:shadow-lg active:scale-95 border border-[#009688]",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"LIMPIAR FILTROS"})})]})}),e.jsx("div",{className:"block w-full m-auto sm:hidden relative",children:e.jsxs("div",{className:"p-4 flex flex-col gap-4 border rounded shadow-[0_0_10px_rgba(0,0,0,0.25)] shadow-[#00786F] bg-white",children:[e.jsx("input",{type:"text",value:g,onChange:a=>b(a.target.value),placeholder:"Buscar",className:"p-3 shadow rounded-lg w-full outline-none focus:ring-2 focus:ring-[#009688] text-[#009688] font-semibold bg-white mb-2",style:{boxShadow:"0 2px 8px rgba(0,0,0,0.10)"}}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("button",{type:"button",className:"flex-1 py-2 rounded-lg font-bold uppercase text-[#009688] bg-white shadow hover:bg-[#e0f7fa] border border-[#009688]",onClick:()=>A(a=>!a),children:"CATEGORIAS"}),e.jsx("button",{type:"button",className:"flex-1 py-2 rounded-lg font-bold uppercase text-[#009688] bg-white shadow hover:bg-[#e0f7fa] border border-[#009688]",onClick:()=>{b(""),h(null)},children:"LIMPIAR FILTRO"})]}),I&&e.jsxs("div",{className:"flex flex-col gap-3 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>h(l==="Decoración"?null:"Decoración"),className:`py-3 rounded-xl text-base font-bold uppercase shadow-md w-full transition-all duration-150 active:scale-95 hover:opacity-90 hover:shadow-lg ${l==="Decoración"?"ring-2 ring-white":""}`,style:{background:"#5D39FB",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"DECORACIÓN"}),e.jsx("button",{type:"button",onClick:()=>h(l==="Maquinaria"?null:"Maquinaria"),className:`py-3 rounded-xl text-base font-bold uppercase shadow-md w-full transition-all duration-150 active:scale-95 hover:opacity-90 hover:shadow-lg ${l==="Maquinaria"?"ring-2 ring-white":""}`,style:{background:"#04B088",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"MAQUINARIA"}),e.jsx("button",{type:"button",onClick:()=>h(l==="Negocio"?null:"Negocio"),className:`py-3 rounded-xl text-base font-bold uppercase shadow-md w-full transition-all duration-150 active:scale-95 hover:opacity-90 hover:shadow-lg ${l==="Negocio"?"ring-2 ring-white":""}`,style:{background:"#00B6FF",color:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.10)"},children:"NEGOCIO"})]})]})}),e.jsx("section",{className:`w-full xl:w-9/12 grid grid-rows-auto space-y-6 md:space-y-10 p-4
      rounded-md shadow-[0_0_7px_rgba(0,0,0,0.25)] shadow-[#00786F] sm:shadow-none sm:rounded-none m-auto`,children:D.map((a,i)=>a.productosDeLaSeccion.length>0&&e.jsx(B,{...a},`${i}`))})]})}function $(){return e.jsxs("section",{className:"flex justify-between gap-6 p-10",children:[e.jsx("div",{className:"bg-gray-300 animate-pulse h-56 w-3/12 rounded"}),e.jsx("div",{className:"w-9/12 grid grid-rows-auto",children:[1,2,3].map(o=>e.jsx("div",{className:"flex justify-center relative",children:e.jsx("div",{className:"relative w-full place-self-center",children:e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-2 xs:gap-3 sm:gap-6 md:gap-8",children:[1,2,3,4,5,6,7,8].map(t=>e.jsxs("div",{className:"my-4 sm:my-6 md:my-10 flex flex-col items-center",children:[e.jsx("div",{className:"bg-gray-300 animate-pulse rounded-[15%] w-4/5 h-4/5 md:h-56 md:w-56 mb-3"}),e.jsx("div",{className:"bg-gray-300 animate-pulse h-4 w-3/4 rounded"})]},t))})})},o))})]})}const L=R.memo(function({productosDeLaSeccion:t}){const c=s.useMemo(()=>t.map(n=>e.jsx(T,{producto:n},n.id)),[t]);return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 xl:grid-cols-3 gap-6 ",children:c})}),B=L;function U(o={}){const[t,c]=s.useState(!1),n=s.useRef(null);return s.useEffect(()=>{const d=n.current;if(!d)return;const x=new IntersectionObserver(([m])=>{m.isIntersecting&&c(!0)},{threshold:.1,rootMargin:"100px",...o});return x.observe(d),()=>x.unobserve(d)},[o]),{targetRef:n,hasIntersected:t}}const q=o=>{switch(o){case"Negocio":return"#00B6FF";case"Decoración":return"#5D39FB";case"Maquinaria":return"#04B088";default:return"#0374A2"}},j=16,P=R.memo(function({producto:t}){const[c,n]=s.useState(!1),{targetRef:d,hasIntersected:x}=U(),m=s.useMemo(()=>{const u=t.imagenes?.[0]?.url_imagen;return u?u.startsWith("http")?u:`${O.replace(/\/$/,"")}${u}`:`https://placehold.co/300x300/e5e7eb/6b7280?text=${encodeURIComponent(t.nombre)}`},[t.imagenes,t.nombre]),f=q(t.seccion);return e.jsx("a",{href:`/productos/${t.link}`,title:`Ver detalles de ${t.nombre}`,className:"w-full",children:e.jsxs("div",{className:"flex flex-row md:flex-col w-full max-w-[380px] min-h-[140px] md:min-h-[340px] bg-white rounded-xl shadow-md border relative overflow-hidden",style:{borderColor:f,boxShadow:"0 4px 16px rgba(0,0,0,0.10)",borderRadius:j},children:[e.jsxs("div",{className:"flex w-full md:hidden min-h-[190px]",style:{height:"100%"},children:[e.jsxs("div",{ref:d,className:"flex items-center justify-center p-2 w-1/2 h-full",style:{height:"100%"},children:[!c&&e.jsx("div",{className:"bg-gray-300 animate-pulse w-full h-full rounded-l-xl"}),x&&e.jsx("img",{src:m,alt:t.nombre,loading:"lazy",onLoad:()=>n(!0),className:"object-contain w-full h-full rounded-l-xl",style:{background:"#f8f8f8"}})]}),e.jsxs("div",{className:"flex flex-col justify-between w-1/2 h-full relative",style:{background:f,borderRadius:"0 12px 12px 0",height:"auto",minHeight:"100%",alignSelf:"stretch",position:"relative"},children:[e.jsx("div",{className:"flex-1 flex items-center justify-center px-2",children:e.jsx("h3",{className:"text-base font-bold uppercase text-white text-start break-words",children:t.nombre})}),e.jsx("button",{className:"bg-white font-bold text-lg text-[#0374A2] px-5 py-2 shadow border-none",style:{minWidth:"90px",minHeight:"40px",borderRadius:"16px 0 16px 0",position:"absolute",right:0,bottom:0,margin:0,padding:0},children:"Comprar"})]})]}),e.jsxs("div",{className:"hidden w-full h-full md:flex md:flex-col",children:[e.jsxs("div",{ref:d,className:"w-full h-[250px] flex items-center justify-center pt-2 pb-2",children:[!c&&e.jsx("div",{className:"absolute inset-0 bg-gray-300 animate-pulse flex items-center justify-center rounded-xl"}),x&&e.jsx("img",{src:m,alt:t.nombre,loading:"lazy",onLoad:()=>n(!0),className:`object-contain w-[95%] h-[95%] transition-opacity duration-300 ${c?"opacity-100":"opacity-0"}`,style:{background:"#f8f8f8",borderRadius:"12px"}})]}),e.jsxs("div",{className:"w-full absolute left-0 bottom-0 overflow-hidden",style:{background:f,borderRadius:`0 0 ${j}px ${j}px`,height:"80px",minHeight:"80px",position:"absolute",left:0,bottom:0,width:"100%",display:"flex",alignItems:"center",margin:0,padding:0},children:[e.jsx("div",{className:"flex flex-row w-full h-full items-center",style:{height:"100%"},children:e.jsx("div",{className:"flex items-center pl-4",style:{maxWidth:"65%",flex:"0 0 65%",height:"100%"},children:e.jsx("h3",{className:"text-base font-bold uppercase text-white break-words whitespace-normal",children:t.nombre})})}),e.jsx("button",{className:"bg-white font-bold text-lg text-[#0374A2] px-5 py-2 shadow border-none",style:{minWidth:"120px",minHeight:"48px",borderRadius:"16px 0 16px 0",position:"absolute",right:0,bottom:0,margin:0,padding:0},children:"Comprar"})]})]})]})})}),T=P;export{W as default};
