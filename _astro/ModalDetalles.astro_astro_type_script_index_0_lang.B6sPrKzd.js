import{c as i}from"./config.BBxWIZNq.js";const m={NEGOCIOS:{gradient:"from-sky-400 to-sky-600",title:"DESCARGA MÁS INFORMACIÓN GRATIS",btn:"bg-sky-400 hover:bg-sky-500 cursor-pointer",buttonText:"¡SÍ, QUIERO CRECER!"},MAQUINARIA:{gradient:"from-emerald-400 to-teal-600",title:"DESCARGA TU <span class='scrollmodal-title'>GUÍA TÉCNICA GRATIS</span>",btn:"bg-emerald-400 hover:bg-emerald-500 cursor-pointer",buttonText:"¡SÍ, QUIERO MI GUÍA!"},DECORACIÓN:{gradient:"from-violet-500 to-indigo-700",title:"TU GUÍA DE DECORACIÓN EXCLUSIVA, GRATIS",btn:"bg-violet-500 hover:bg-violet-600 cursor-pointer",buttonText:"¡SÍ, QUIERO CRECER!"}},d={"soldadora-lingba":"/images/popup/soldadora-lingba.webp","purificador-de-agua":"/images/popup/purificador-de-agua.webp","maquina-de-embalaje-de-te":"/images/popup/maquina-de-embalaje-de-te.webp","maquina-selladora-de-bolsas-para-solidos":"/images/popup/maquina-selladora-de-bolsas-para-solidos.webp","mesa-led-bar-alta-cuadrada":"/images/popup/mesa-led-bar-alta-cuadrada.webp","mesa-led-bar-alta":"/images/popup/mesa-led-bar-alta.webp","selladora-por-induccion":"/images/popup/selladora-por-induccion.webp","selladora-de-vaso-manual":"/images/popup/selladora-de-vaso-manual.webp","silla-bar-led-alta":"/images/popup/silla-bar-led-alta.webp","sillas-cuadradas-o-de-cubo":"/images/popup/sillas-cuadradas-o-de-cubo.webp","soldadora-spark-mig-250":"/images/popup/soldadora-spark-mig-250.webp","ventilador-holografico":"/images/popup/ventilador-holografico.webp","maquina-selladora-de-bolsas-para-liquidos":"/images/popup/maquina-selladora-de-bolsas-para-liquidos.webp",default:"/images/popup/default.webp"},p=document.getElementById("modal-form-container");p?.dataset.whatsapp;let l=m.NEGOCIOS;const C="asesoriaModalLastClosedDetalle",O=180*1e3;let u=!1,E=!1;function g(){v(),b();const e=document.getElementById("modal-cotizacion-producto"),o=document.getElementById("modal-cotizacion-mensaje");e&&o&&(e.classList.remove("hidden"),o.textContent="",u=!0)}function b(){const e=document.getElementById("modal-form-container"),o=document.getElementById("modal-product-img");if(!e||!o)return;const t=e.dataset.productLink||"";console.log("Link del producto desde dataset:",t);const a=d[t]||d.default;console.log("Imagen seleccionada:",a),console.log("Imagen seleccionada:",a);const r=new Image;r.onload=function(){o.src=a,o.alt=`Imagen para ${t}`},r.onerror=function(){console.error("Error al cargar la imagen:",a),o.src=d.default,o.alt="Imagen por defecto"},r.src=a}function S(){const e=parseInt(localStorage.getItem(C)||"0",10);return Date.now()-e>=O}const I=document.getElementById("close-modal-cotizacion");I&&(I.onclick=()=>{const e=document.getElementById("modal-cotizacion-producto");e&&e.classList.add("hidden"),localStorage.setItem(C,Date.now().toString()),u=!1});const c=document.getElementById("form-cotizacion-producto");c&&(c.onsubmit=async e=>{e.preventDefault();const o=new FormData(c),t=o.get("nombre"),a="+51 "+o.get("telefono"),r=o.get("correo"),w=document.getElementById("modal-form-container")?.dataset.productLink,A=`Hola, me llamo ${t}. Teléfono: ${a}, Correo: ${r}. Me interesa recibir asesoría.`;try{const s=await fetch(`${i.apiUrl}${i.endpoints.whatsapp.sendMessageAccept}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({telefono:a,comentario:A})});if(s.ok){const n=await s.json();console.log("Mensaje enviado con éxito:",n)}else{const n=await s.json();console.error("Error al enviar mensaje:",n)}}catch(s){console.error("Error al enviar mensaje a WhatsApp:",s)}const f=document.getElementById("modal-cotizacion-mensaje");f&&(f.textContent="Enviado a WhatsApp ✅");try{if((await fetch(`${i.apiUrl}${i.endpoints.email.sendEmailByProductLink}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,celular:a,email:r,link:w})})).ok){const n=document.getElementById("modal-cotizacion-mensaje");n&&(n.textContent="Correo enviado con éxito ✅")}else{const n=document.getElementById("modal-cotizacion-mensaje");n&&(n.textContent="Error al enviar el correo. Intenta nuevamente.")}}catch(s){console.error("Error al enviar el formulario:",s);const n=document.getElementById("modal-cotizacion-mensaje");n&&(n.textContent="Error al enviar el correo. Intenta nuevamente.")}c.reset()});function v(){const e=document.getElementById("modal-form-container"),o=document.getElementById("modal-title"),t=document.getElementById("modal-submit-btn"),a=document.getElementById("modal-submit-btn");e&&(e.classList.remove("from-sky-400","to-sky-600","from-emerald-400","to-teal-600","from-violet-500","to-indigo-700"),e.classList.add("bg-gradient-to-b",...l.gradient.split(" "))),o&&(o.innerHTML=l.title),t&&(t.classList.remove("bg-sky-400","hover:bg-sky-500","bg-emerald-400","hover:bg-emerald-500","bg-violet-500","hover:bg-violet-600"),t.classList.add(...l.btn.split(" "),"text-white")),a&&(a.textContent=l.buttonText||"Enviar",a.classList.add("font-bold"))}function h(){document.querySelectorAll('[id^="btnQuotation"]').forEach(o=>{o.addEventListener("click",()=>{g()})})}window.addEventListener("open-scroll-modal",g);window.addEventListener("scroll",()=>{window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100>30&&!E&&S()&&!u&&(E=!0,g())});function y(){const e=document.getElementById("modal-form-container");if(!e)return;const t=(e.dataset.seccion||"NEGOCIOS").normalize?.("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase(),r={NEGOCIOS:"NEGOCIOS",MAQUINARIA:"MAQUINARIA",DECORACION:"DECORACIÓN"}[t]||"NEGOCIOS";l=m[r]||m.NEGOCIOS,v()}p&&new MutationObserver(o=>{o.forEach(t=>{t.attributeName==="data-seccion"&&y(),t.attributeName==="data-product-link"&&b()})}).observe(p,{attributes:!0,attributeFilter:["data-seccion","data-product-link"]});document.addEventListener("DOMContentLoaded",function(){localStorage.removeItem("asesoriaModalLastClosedDetalle"),y(),b(),h()});
