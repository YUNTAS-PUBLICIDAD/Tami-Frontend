import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.6otl1p8d.js";import{F as _,a as v}from"./index.Dthj7XIG.js";import{g as j,c as N}from"./config.BxIw3SrH.js";import"./iconBase.Rsx8IN41.js";const y=()=>{const[c,d]=o.useState(!1),[a,i]=o.useState({titulo:"",parrafo:"",descripcion:"",imagen_principal:null,titulo_blog:"",subtitulo_beneficio:"",url_video:"",titulo_video:"",imagenes:[{url_imagen:null,parrafo_imagen:""},{url_imagen:null,parrafo_imagen:""}]}),s=t=>{i({...a,[t.target.name]:t.target.value})},u=t=>{t.target.files&&t.target.files[0]&&i({...a,imagen_principal:t.target.files[0]})},g=(t,n)=>{if(t.target.files&&t.target.files[0]){const l=[...a.imagenes];l[n]={...l[n],url_imagen:t.target.files[0]},i({...a,imagenes:l})}},p=(t,n)=>{const l=[...a.imagenes];l[n]={...l[n],parrafo_imagen:t.target.value},i({...a,imagenes:l})},r=()=>{d(!1),i({titulo:"",parrafo:"",descripcion:"",imagen_principal:null,titulo_blog:"",subtitulo_beneficio:"",url_video:"",titulo_video:"",imagenes:[{url_imagen:null,parrafo_imagen:""},{url_imagen:null,parrafo_imagen:""}]})},m=async t=>{if(t.preventDefault(),!a.titulo||!a.parrafo||!a.descripcion||!a.subtitulo_beneficio||!a.titulo_blog||!a.titulo_video||!a.url_video||!a.imagen_principal||!a.imagenes||a.imagenes.some(n=>!n.url_imagen)){alert("⚠️ Todos los campos son obligatorios.");return}try{const n=localStorage.getItem("token"),l=new FormData;l.append("titulo",a.titulo),l.append("parrafo",a.parrafo),l.append("descripcion",a.descripcion),l.append("subtitulo_beneficio",a.subtitulo_beneficio),l.append("titulo_blog",a.titulo_blog),l.append("titulo_video",a.titulo_video),l.append("url_video",a.url_video),a.imagenes.forEach((x,f)=>{x.url_imagen&&l.append(`imagenes[${f}][url_imagen]`,x.url_imagen),l.append(`imagenes[${f}][parrafo_imagen]`,x.parrafo_imagen)}),l.append("imagen_principal",a.imagen_principal);const h=await fetch(j(N.endpoints.blogs.create),{method:"POST",body:l,headers:{Authorization:`Bearer ${n}`}}),b=await h.json();console.log("Respuesta del servidor:",b),h.ok?(alert("✅ Blog añadido exitosamente"),r()):alert(`❌ Error: ${b.message}`)}catch(n){console.error("Error al enviar los datos:",n),alert(`❌ Error: ${n}`)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>d(!0),className:"mt-4 bg-teal-500 hover:bg-teal-600 text-white text-lg px-10 py-1.5 rounded-full flex items-center gap-2",children:"Añadir Blog"}),c&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50",children:e.jsxs("div",{className:"h-3/4 overflow-y-scroll bg-teal-600 text-white px-10 py-8 rounded-4xl w-3/5",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"AÑADIR BLOG"}),e.jsxs("form",{encType:"multipart/form-data",onSubmit:m,className:"grid grid-cols-2 gap-4 gap-x-12",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Título"}),e.jsx("input",{type:"text",name:"titulo",value:a.titulo,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Párrafo"}),e.jsx("input",{type:"text",name:"parrafo",value:a.parrafo,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"Descripción"}),e.jsx("input",{type:"text",name:"descripcion",value:a.descripcion,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"Subtítulo Beneficio"}),e.jsx("input",{type:"text",name:"subtitulo_beneficio",value:a.subtitulo_beneficio,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Título Blog"}),e.jsx("input",{type:"text",name:"titulo_blog",value:a.titulo_blog,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block",children:"Título Video"}),e.jsx("input",{type:"text",name:"titulo_video",value:a.titulo_video,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"URL del Video"}),e.jsx("input",{type:"text",name:"url_video",value:a.url_video,onChange:s,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block",children:"Imagen Principal"}),e.jsx("input",{type:"file",accept:"image/png, image/jpeg, image/jpg",name:"imagen_principal",onChange:u,required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"})]}),a.imagenes.map((t,n)=>e.jsxs("div",{className:"col-span-2",children:[e.jsxs("label",{className:"block",children:["Imagen ",n+1]}),e.jsx("input",{type:"file",accept:"image/*",onChange:l=>{g(l,n)},required:!0,className:"w-full bg-white outline-none p-2 rounded-md text-black"}),e.jsx("textarea",{onChange:l=>{p(l,n)},required:!0,placeholder:"Descripción de la imagen...",className:"w-full bg-white outline-none p-2 rounded-md text-black mt-2 min-h-36"})]},n)),e.jsxs("div",{className:"flex gap-2 mt-8",children:[e.jsx("button",{type:"submit",className:"admin-act-btn",children:"Añadir Blog"}),e.jsx("button",{onClick:r,type:"button",className:"cancel-btn",children:"Cancelar"})]})]})]})})]})},P=()=>{const[c,d]=o.useState([]),[a,i]=o.useState(1),s=10;o.useEffect(()=>{(async()=>{try{const l=await(await fetch(j(N.endpoints.blogs.list))).json();console.log("Datos recibidos:",l),d(l.data||[])}catch(n){console.error("❌ Error al cargar datos:",n)}})()},[]);const u=a*s,g=u-s,p=c.slice(g,u),r=t=>{i(t)},m=Math.ceil(c.length/s);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-separate border-spacing-2",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-teal-600 text-white",children:[e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"ID"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"TÍTULO"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"PÁRRAFO"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"DESCRIPCIÓN"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"IMAGEN"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"ACCIÓN"})]})}),e.jsx("tbody",{children:p.length>0?p.map(t=>e.jsxs("tr",{className:`text-center ${t.id%2===0?"bg-gray-100":"bg-gray-300"}`,children:[e.jsx("td",{className:"px-4 font-bold rounded-xl",children:t.id}),e.jsx("td",{className:"px-4 font-bold rounded-xl",children:t.titulo}),e.jsx("td",{className:"px-4 rounded-xl",children:t.parrafo}),e.jsx("td",{className:"px-4 rounded-xl",children:t.descripcion}),e.jsx("td",{className:"px-4 rounded-xl",children:e.jsx("img",{src:t.imagenPrincipal,alt:t.titulo,className:"w-16 h-16 rounded-md mx-auto"})}),e.jsx("td",{className:"px-4 rounded-xl",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx("button",{className:"p-2 text-red-600 hover:text-red-800 transition",title:"Eliminar",children:e.jsx(_,{size:18})}),e.jsx("button",{className:"p-2 text-green-600 hover:text-green-800 transition",title:"Confirmar",children:e.jsx(v,{size:18})})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-500",children:"Cargando datos..."})})})]})}),e.jsxs("div",{className:"flex justify-center mt-4",children:[e.jsx("button",{onClick:()=>r(a-1),disabled:a===1,className:"pagination-btn",children:"Anterior"}),e.jsx("span",{className:"mx-4 self-center",children:`Página ${a} de ${m}`}),e.jsx("button",{onClick:()=>r(a+1),disabled:a===m,className:"pagination-btn",children:"Siguiente"})]}),e.jsx(y,{})]})};export{P as default};
