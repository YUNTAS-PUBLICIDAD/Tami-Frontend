import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as m}from"./index.DtoOFyvK.js";import{F as ee,a as te,b as ae,c as re,d as se}from"./index.BK6zlZpu.js";import{g as B,c as F}from"./config.BBxWIZNq.js";import{S as d}from"./sweetalert2.esm.all.Bj_ZQUAw.js";import"./iconBase.BJk3kZaN.js";const c={titulo:120,parrafo:100,descripcion:255,videoTitulo:40,videoUrl:255,metaTitulo:60,metaDescripcion:160},q=2,R=["image/jpeg","image/jpg","image/png","image/webp"],Q=k=>{try{const f=new URL(k);return!!f.protocol&&!!f.host}catch{return!1}},Z=k=>k/(1024*1024),ie=({onBlogAdded:k,isOpen:f,onClose:x,blogToEdit:n})=>{const[_,z]=m.useState(!1),[D,p]=m.useState(!1),[E,M]=m.useState([]),[U,$]=m.useState(!1),[S,C]=m.useState(""),[w,P]=m.useState(""),[b,N]=m.useState(null),[G,I]=m.useState(!1),[t,u]=m.useState({titulo:"",link:"",subtitulo1:"",subtitulo2:"",video_url:"",video_titulo:"",producto_id:"",miniatura:null,imagenes:[{imagen:null,parrafo:""},{imagen:null,parrafo:""}],etiqueta:{meta_titulo:"",meta_descripcion:""}});m.useEffect(()=>{f!==void 0&&z(f)},[f]),m.useEffect(()=>{if(!_)return;if((async()=>{try{const a=B(F.endpoints.productos.list),o=await(await fetch(a,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,Accept:"application/json"}})).json();let l=[];Array.isArray(o)?l=o:Array.isArray(o?.data)?l=o.data:Array.isArray(o?.data?.productos)&&(l=o.data.productos),M(l)}catch(a){console.error("üö´ Error en FETCH productos:",a),M([])}})(),n){const a=E.find(r=>r.nombre===n.nombre_producto);u({titulo:n.titulo||"",link:n.link||"",subtitulo1:n.subtitulo1||"",subtitulo2:n.subtitulo2||"",video_url:n.video_url||"",video_titulo:n.video_titulo||"",producto_id:a?String(a.id):"",miniatura:n.miniatura||null,imagenes:n.imagenes?.map((r,o)=>{const l=r.ruta_imagen||"";return{imagen:null,parrafo:n.parrafos?.[o]?.parrafo||"",url:l?l.startsWith("http")?l:`https://apitami.tamimaquinarias.com${l}`:""}})||[{imagen:null,parrafo:"",url:""},{imagen:null,parrafo:"",url:""}],etiqueta:{meta_titulo:n.etiqueta?.meta_titulo||"",meta_descripcion:n.etiqueta?.meta_descripcion||""}})}else u({titulo:"",link:"",subtitulo1:"",subtitulo2:"",video_url:"",video_titulo:"",producto_id:"",miniatura:null,imagenes:[{imagen:null,parrafo:""},{imagen:null,parrafo:""}],etiqueta:{meta_titulo:"",meta_descripcion:""}})},[_,n]);const v=s=>{const{name:a,value:r}=s.target;if(a==="link"){const l=r.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replaceAll(" ","-");u(y=>({...y,link:l}));return}if(a==="producto_id"){u(l=>({...l,producto_id:r}));return}const o={};switch(a){case"titulo":o.titulo=r.slice(0,c.titulo);break;case"subtitulo1":o.subtitulo1=r.slice(0,c.parrafo);break;case"subtitulo2":o.subtitulo2=r.slice(0,c.descripcion);break;case"video_titulo":o.video_titulo=r.slice(0,c.videoTitulo);break;case"video_url":o.video_url=r.slice(0,c.videoUrl);break}u(l=>({...l,...o}))},V=s=>{const a=s.target.files?.[0];if(a){if(!R.includes(a.type)){d.fire("Formato no v√°lido","Solo JPG, JPEG, PNG o WEBP.","warning");return}if(Z(a.size)>q){d.fire("Imagen muy pesada",`M√°ximo ${q} MB.`,"warning");return}u({...t,miniatura:a})}},W=(s,a)=>{const r=s.target.files?.[0];if(!r)return;if(!R.includes(r.type)){d.fire("Formato no v√°lido","Solo JPG, JPEG, PNG o WEBP.","warning");return}if(Z(r.size)>q){d.fire("Imagen muy pesada",`M√°ximo ${q} MB.`,"warning");return}const o=[...t.imagenes];o[a]={...o[a],imagen:r},u({...t,imagenes:o})},T=(s,a)=>{const r=[...t.imagenes];r[a]={...r[a],parrafo:s.target.value},u({...t,imagenes:r})},J=s=>{const a=document.getElementById(`crear_descripcion_antes_${s}`),r=a.selectionStart,o=a.selectionEnd,l=a.value.substring(r,o);if(!l){d.fire("Selecciona texto","Selecciona texto para enlazar.","warning");return}N(s),C(l),$(!0)},H=s=>{const a=document.getElementById(`crear_descripcion_antes_${s}`),r=a.selectionStart,o=a.selectionEnd,l=a.value.substring(r,o);if(!l){d.fire("Selecciona texto","Selecciona texto para enlazar.","warning");return}N(s),C(l),I(!0)},i=()=>{if(b===null)return;if(!t.producto_id){d.fire("ID de producto vac√≠o","Selecciona un producto.","error");return}const s=E.find(K=>String(K.id)===String(t.producto_id));if(!s?.link){d.fire("Producto no encontrado","No se encontr√≥ el producto.","error");return}const a=document.getElementById(`crear_descripcion_antes_${b}`),r=a.selectionStart,o=a.selectionEnd,l=t.imagenes[b]?.parrafo||"",y=l.substring(0,r),j=l.substring(o),L=`<a href="${`/productos/detalle?link=${s.link}`}" style="text-decoration: underline;" title="${s.link}">${S}</a>`,X=y+L+j,Y=[...t.imagenes];Y[b]={...Y[b],parrafo:X},u(K=>({...K,imagenes:Y})),I(!1),C(""),N(null)},g=()=>{if(b===null)return;if(!w.trim()||!Q(w.trim())){d.fire("Enlace inv√°lido","Ingresa una URL v√°lida (https://...).","error");return}const s=document.getElementById(`crear_descripcion_antes_${b}`),a=s.selectionStart,r=s.selectionEnd,o=t.imagenes[b]?.parrafo||"",l=o.substring(0,a),y=o.substring(r),j=`<a href="${w.trim()}" style="text-decoration: underline;" title="${S}">${S}</a>`,O=l+j+y,L=[...t.imagenes];L[b]={...L[b],parrafo:O},u(X=>({...X,imagenes:L})),$(!1),P(""),C(""),N(null)},h=()=>{z(!1),u({titulo:"",link:"",subtitulo1:"",subtitulo2:"",video_url:"",video_titulo:"",producto_id:"",miniatura:null,imagenes:[{imagen:null,parrafo:""},{imagen:null,parrafo:""}],etiqueta:{meta_titulo:"",meta_descripcion:""}})},A=async s=>{if(s.preventDefault(),p(!0),t.titulo.length===0||t.titulo.length>c.titulo){d.fire("Error",`El t√≠tulo es obligatorio y m√°x. ${c.titulo} caracteres.`,"error"),p(!1);return}if(t.subtitulo1.length===0||t.subtitulo1.length>c.parrafo){d.fire("Error",`El p√°rrafo es obligatorio y m√°x. ${c.parrafo} caracteres.`,"error"),p(!1);return}if(t.subtitulo2.length===0||t.subtitulo2.length>c.descripcion){d.fire("Error",`La descripci√≥n es obligatoria y m√°x. ${c.descripcion} caracteres.`,"error"),p(!1);return}if(t.video_titulo.length===0||t.video_titulo.length>c.videoTitulo){d.fire("Error",`El t√≠tulo del video es obligatorio y m√°x. ${c.videoTitulo} caracteres.`,"error"),p(!1);return}if(t.video_url.length===0||t.video_url.length>c.videoUrl||!Q(t.video_url)){d.fire("Error",`La URL del video es obligatoria, m√°x. ${c.videoUrl} y debe ser v√°lida.`,"error"),p(!1);return}if(!t.producto_id){d.fire("Error","Selecciona un producto.","error"),p(!1);return}if(!n&&!t.miniatura){d.fire("Error","La miniatura es obligatoria.","error"),p(!1);return}if(t.imagenes.some(a=>!n&&!a.imagen||!a.parrafo)){d.fire("Error","Cada imagen adicional y su descripci√≥n son obligatorias.","error"),p(!1);return}try{const a=localStorage.getItem("token"),r=new FormData;r.append("titulo",t.titulo),r.append("link",t.link),r.append("subtitulo1",t.subtitulo1),r.append("subtitulo2",t.subtitulo2),r.append("video_url",t.video_url),r.append("video_titulo",t.video_titulo),r.append("meta_titulo",t.etiqueta.meta_titulo),r.append("meta_descripcion",t.etiqueta.meta_descripcion),r.append("producto_id",t.producto_id.toString()),t.miniatura instanceof File&&r.append("miniatura",t.miniatura),t.imagenes.forEach(j=>{j.imagen&&r.append("imagenes[]",j.imagen),r.append("parrafos[]",j.parrafo),r.append("text_alt[]","Sin descripci√≥n")}),n&&r.append("_method","POST");const o=n?`${B(F.endpoints.blogs.list)}/${n.id}`:B(F.endpoints.blogs.create),l=await fetch(o,{method:"POST",headers:{Authorization:`Bearer ${a}`},body:r}),y=await l.json();if(console.log("response",l),console.log("data",y),l.ok)await d.fire({icon:"success",title:n?"Blog actualizado exitosamente":"Blog a√±adido exitosamente",showConfirmButton:!0}),h(),k();else if(y.errors){const j=Object.entries(y.errors).map(([O,L])=>`- ${O}: ${L.join(", ")}`).join(`
`);d.fire({icon:"error",title:"Errores de validaci√≥n",text:j})}else d.fire({icon:"error",title:"Error",text:`‚ùå ${y.message||"Error al guardar blog"}`})}catch(a){console.error("Error al enviar los datos:",a),d.fire({icon:"error",title:"Error",text:`‚ùå ${a}`})}finally{p(!1)}};return e.jsx(e.Fragment,{children:(_||f)&&e.jsx("div",{className:"dialog-overlay",children:e.jsxs("div",{className:"max-h-[90vh] dialog",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-teal-600",children:n?"Editar Blog":"A√±adir Nuevo Blog"}),e.jsx("button",{type:"button",onClick:x||h,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"√ó"})]}),e.jsxs("form",{encType:"multipart/form-data",onSubmit:A,className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"T√≠tulo*"}),e.jsx("input",{type:"text",name:"titulo",value:t.titulo,onChange:v,maxLength:c.titulo,required:!0})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"Link*"}),e.jsx("input",{type:"text",name:"link",value:t.link,onChange:v,maxLength:c.titulo,required:!0})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"Meta t√≠tulo"}),e.jsx("input",{type:"text",name:"meta_titulo",value:t.etiqueta.meta_titulo,onChange:s=>u({...t,etiqueta:{...t.etiqueta,meta_titulo:s.target.value.slice(0,c.metaTitulo)}}),maxLength:c.metaTitulo}),e.jsx("small",{className:"text-gray-500",children:"M√°ximo 10 caracteres"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"Meta descripci√≥n"}),e.jsx("textarea",{name:"meta_descripcion",value:t.etiqueta.meta_descripcion,onChange:s=>u({...t,etiqueta:{...t.etiqueta,meta_descripcion:s.target.value.slice(0,c.metaDescripcion)}}),maxLength:c.metaDescripcion,rows:3}),e.jsx("small",{className:"text-gray-500",children:"M√°ximo 40 caracteres"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"P√°rrafo*"}),e.jsx("input",{type:"text",name:"subtitulo1",value:t.subtitulo1,onChange:v,maxLength:c.parrafo,required:!0})]}),e.jsxs("div",{className:"md:col-span-2 form-input",children:[e.jsx("label",{className:"font-medium",children:"Descripci√≥n*"}),e.jsx("input",{type:"text",name:"subtitulo2",value:t.subtitulo2,onChange:v,maxLength:c.descripcion,required:!0})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"T√≠tulo Video*"}),e.jsx("input",{type:"text",name:"video_titulo",value:t.video_titulo,onChange:v,maxLength:c.videoTitulo,required:!0})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"font-medium",children:"URL del Video*"}),e.jsx("input",{type:"url",name:"video_url",value:t.video_url,onChange:v,maxLength:c.videoUrl,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition",placeholder:"https://www.youtube.com/watch?v=..."})]}),e.jsxs("div",{className:"md:col-span-2 form-input",children:[e.jsx("label",{className:"font-medium",children:"Producto*"}),e.jsxs("select",{name:"producto_id",value:t.producto_id,onChange:v,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition",children:[e.jsx("option",{value:"",children:"Selecciona un producto"}),E.map(s=>e.jsx("option",{value:String(s.id),children:s.nombre},s.id))]}),e.jsx("small",{className:"text-gray-500",children:"Selecciona el producto relacionado."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Miniatura",!n&&"*"]}),t.miniatura instanceof File?e.jsx("img",{src:URL.createObjectURL(t.miniatura),alt:"Vista previa miniatura",className:"w-32 h-32 object-cover rounded-md border mb-2"}):typeof t.miniatura=="string"&&t.miniatura?e.jsx("img",{src:String(t.miniatura).startsWith("http")?String(t.miniatura):`https://apitami.tamimaquinarias.com${t.miniatura}`,alt:"Miniatura actual",className:"w-32 h-32 object-cover rounded-md border mb-2"}):null,e.jsx("input",{type:"file",accept:R.join(","),onChange:V,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition"}),e.jsxs("small",{className:"text-gray-500",children:["Formatos permitidos: JPG, JPEG, PNG, WEBP. M√°x. ",q," ","MB."]})]}),t.imagenes.map((s,a)=>e.jsxs("div",{className:"md:col-span-2 form-input",children:[e.jsxs("label",{className:"font-medium",children:["Imagen Adicional ",a+1,!n&&"*"]}),s.imagen instanceof File?e.jsx("img",{src:URL.createObjectURL(s.imagen),alt:`Vista previa imagen ${a+1}`,className:"w-32 h-32 object-cover rounded-md border mb-2"}):s.url?e.jsx("img",{src:s.url.startsWith("http")?s.url:`https://apitami.tamimaquinarias.com${s.url}`,alt:`Imagen adicional ${a+1}`,className:"w-32 h-32 object-cover rounded-md border mb-2"}):null,e.jsx("div",{className:"flex items-center gap-4 mb-2",children:e.jsx("label",{className:"flex-1 cursor-pointer",children:e.jsxs("div",{className:"px-4 py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-teal-500 transition",children:[e.jsx("input",{type:"file",accept:R.join(","),onChange:r=>W(r,a),className:"hidden"}),e.jsx("p",{className:"text-center text-gray-500",children:s.imagen instanceof File?s.imagen.name:"Seleccionar archivo"})]})})}),e.jsxs("div",{className:"md:col-span-2 form-input",children:[e.jsx("label",{className:"font-medium",children:"Descripci√≥n Completa*"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{name:"descripcionAntes",id:`crear_descripcion_antes_${a}`,rows:5,value:t.imagenes[a]?.parrafo||"",onChange:r=>T(r,a),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition resize-none",placeholder:"Escribe aqu√≠ toda la descripci√≥n del blog...",required:!0}),e.jsxs("div",{className:"absolute top-2/3 right-2 flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>J(a),title:"Insertar enlace",className:"bg-blue-500 hover:bg-blue-700 text-white p-2 rounded-full shadow-lg transition-all duration-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsx("button",{type:"button",onClick:()=>H(a),title:"Enlazar a producto",className:"bg-green-500 hover:bg-green-700 text-white p-2 rounded-full shadow-lg transition-all duration-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Selecciona texto y haz clic en:",e.jsx("span",{className:"mx-2",children:"üîó para enlace normal"}),e.jsx("span",{className:"mx-2",children:"üõí para enlace a producto"})]})]})]},a)),e.jsxs("div",{className:"md:col-span-2 flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:x||h,className:"px-6 py-2 border border-gray-300 dark:border-gray-800 dark:bg-gray-900 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 transition",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition shadow-md flex items-center justify-center gap-2 min-w-[140px]",disabled:D,children:D?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})]}),"Guardando..."]}):n?"Actualizar Blog":"Guardar Blog"})]})]}),U&&e.jsx("div",{className:"dialog-overlay",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-sm",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4",children:['Insertar enlace para "',S,'"']}),e.jsx("input",{type:"url",placeholder:"https://ejemplo.com",value:w,onChange:s=>P(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded mb-4"}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>$(!1),className:"px-4 py-2 bg-gray-300 dark:bg-gray-900 rounded",children:"Cancelar"}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Insertar"})]})]})}),G&&e.jsx("div",{className:"dialog-overlay",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-2xl max-h-[80vh] overflow-y-auto form-input",children:[e.jsxs("h3",{className:"text-xl font-bold mb-4",children:['Enlazar "',S,'" a producto:']}),e.jsxs("select",{name:"producto_id",value:t.producto_id,onChange:v,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition",children:[e.jsx("option",{value:"",children:"Selecciona un producto"}),E.map(s=>e.jsx("option",{value:s.id,children:s.nombre},s.id))]}),e.jsxs("div",{className:"flex justify-end gap-2 p-6",children:[e.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 bg-gray-300 dark:bg-gray-900 rounded",children:"Cancelar"}),e.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Insertar"})]})]})})]})})})},me=()=>{const[k,f]=m.useState([]),[x,n]=m.useState(1),[_,z]=m.useState(""),[D,p]=m.useState(!1),[E,M]=m.useState(!0),[U,$]=m.useState(null),[S,C]=m.useState(null),w=6,P=async()=>{M(!0);try{const g=await(await fetch(B(F.endpoints.blogs.list))).json();Array.isArray(g?.data)?f(g.data):(console.warn("‚ö†Ô∏è 'data' no es un array v√°lido:",g?.data),f([]))}catch(i){console.error("‚ùå Error al cargar datos:",i),f([])}finally{M(!1)}};m.useEffect(()=>{P()},[]);const b=()=>{P(),p(!1)},N=k.filter(i=>i.titulo.toLowerCase().includes(_.toLowerCase())||i.subtitulo2.toLowerCase().includes(_.toLowerCase())),G=x*w,I=G-w,t=N.slice(I,G),u=Math.ceil(N.length/w),v=async i=>{const g=localStorage.getItem("token");if((await d.fire({title:"¬øEst√°s seguro de que deseas eliminar este blog?",icon:"warning",showCancelButton:!0,confirmButtonText:"S√≠, eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{(await fetch(B(F.endpoints.blogs.delete(i)),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}})).ok?(f(s=>s.filter(a=>a.id!==i)),await d.fire("Eliminado","Blog eliminado exitosamente","success")):await d.fire("Error","Error al eliminar el blog","error")}catch(A){console.error("Error al eliminar:",A),await d.fire("Error","Error al conectar con el servidor","error")}},V=()=>{p(!0)},W=i=>{C(i),p(!0)},T=i=>{$(i)},J=()=>{$(null)},H=({blog:i,onClose:g})=>i?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-screen overflow-y-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:`${B("")}${i.imagenes[0]?.ruta_imagen}`,alt:i.titulo,className:"w-full h-64 object-cover rounded-t-xl"}),e.jsx("button",{onClick:g,className:"absolute top-4 right-4 bg-white rounded-full p-2 shadow-lg cursor-pointer",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-teal-700 mb-2",children:i.titulo}),e.jsx("p",{className:"text-gray-500 mb-4",children:i.created_at?new Date(i.created_at).toLocaleDateString():"Fecha no disponible"}),e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("h3",{className:"text-xl font-semibold text-teal-600 mb-2",children:i.subtitulo1}),e.jsxs("div",{className:"my-6",children:[e.jsx("h4",{className:"text-lg font-medium text-teal-600 mb-2",children:"Acerca de este blog"}),e.jsx("p",{className:"text-gray-700",children:i.subtitulo2})]}),i.parrafos?.map((h,A)=>e.jsx("p",{className:"text-gray-700 mb-4",children:h.parrafo},A)),i.video_id?.trim()&&e.jsxs("div",{className:"my-6",children:[e.jsx("h4",{className:"text-lg font-medium text-teal-600 mb-2",children:i.video_titulo||"Video relacionado"}),e.jsx("div",{className:"aspect-w-16 aspect-h-9",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${i.video_id.trim()}`,className:"w-full h-64 rounded-lg",allowFullScreen:!0})})]})]})]})]})}):null;return e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 min-h-screen pb-12 sm:pb-16 md:pb-20 lg:pb-24 xl:pb-28",children:[e.jsx("div",{className:"bg-gradient-to-r from-teal-600 to-teal-400 text-white p-8 shadow-md",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Gesti√≥n de Blog"}),e.jsx("p",{className:"text-teal-50",children:"Administra todas las publicaciones del blog de tu empresa"})]})}),e.jsx("div",{className:"container mx-auto px-4 -mt-6",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"relative flex-grow max-w-md",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ee,{className:"text-gray-400 dark:text-gray-300"})}),e.jsx("input",{type:"text",className:"pl-10 pr-4 py-2 w-full border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:ring-teal-500 focus:border-teal-500",placeholder:"Buscar blogs...",value:_,onChange:i=>z(i.target.value)})]}),e.jsxs("button",{type:"button",onClick:V,className:"flex items-center gap-2 bg-teal-600 text-white px-4 py-2 rounded-full shadow hover:bg-teal-700 flex-shrink-0",children:[e.jsx(te,{}),"A√±adir Blog"]}),e.jsx(ie,{onBlogAdded:b,isOpen:D,onClose:()=>{p(!1),C(null)},blogToEdit:S})]}),E?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500"})}):t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(i=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 rounded-xl shadow-sm hover:shadow-md transition-shadow overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"relative h-48",children:[e.jsx("img",{src:`${B("")}${i.imagenes[0]?.ruta_imagen}`,alt:i.titulo,className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute top-0 right-0 m-2 flex space-x-1",children:[e.jsx("button",{onClick:()=>T(i),className:"p-2 bg-white dark:bg-gray-900 rounded-full hover:bg-teal-50 dark:hover:bg-gray-700 text-teal-600 shadow-md cursor-pointer",title:"Vista previa",children:e.jsx(ae,{size:16})}),e.jsx("button",{className:"p-2 bg-white dark:bg-gray-900 rounded-full hover:bg-yellow-50 dark:hover:bg-gray-700 text-yellow-600 shadow-md cursor-pointer",title:"Editar",onClick:()=>W(i),children:e.jsx(re,{size:16})}),e.jsx("button",{onClick:()=>v(i.id),className:"p-2 bg-white dark:bg-gray-900 rounded-full hover:bg-red-50 dark:hover:bg-gray-700 text-red-600 shadow-md cursor-pointer",title:"Eliminar",children:e.jsx(se,{size:16})})]})]}),e.jsxs("div",{className:"p-5 flex-grow flex flex-col",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 dark:text-gray-100 mb-2 line-clamp-1",children:i.titulo}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-3 line-clamp-2",children:i.subtitulo2}),e.jsxs("div",{className:"mt-auto pt-4 flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ",i.id]}),e.jsx("span",{className:"px-3 py-1 bg-teal-50 dark:bg-teal-800 text-teal-600 dark:text-teal-200 rounded-full text-xs font-medium",children:"Blog"})]})]})]},i.id))}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400 dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-gray-900 dark:text-gray-100",children:"No se encontraron blogs"}),e.jsx("p",{className:"mt-1 text-gray-500 dark:text-gray-400",children:"Intenta con otra b√∫squeda o crea un nuevo blog."})]}),N.length>0&&e.jsxs("div",{className:"flex justify-center gap-2 mt-8",children:[e.jsx("button",{onClick:()=>n(i=>Math.max(i-1,1)),disabled:x===1,className:`${x===1?"":"cursor-pointer"} px-3 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 text-sm text-gray-700 dark:text-gray-200`,children:"Anterior"}),Array.from({length:Math.min(u,5)},(i,g)=>{let h;return u<=5||x<=3?h=g+1:x>=u-2?h=u-4+g:h=x-2+g,e.jsx("button",{onClick:()=>n(h),className:`px-3 py-1 border rounded-md text-sm cursor-pointer ${x===h?"bg-teal-500 text-white border-teal-500":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}`,children:h},g)}),e.jsx("button",{onClick:()=>n(i=>Math.min(i+1,u)),disabled:x===u,className:`${x===u?"":"cursor-pointer"} px-3 py-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 text-sm text-gray-700 dark:text-gray-200`,children:"Siguiente"})]})]})}),U&&e.jsx(H,{blog:U,onClose:J})]})};export{me as default};
