import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{g as $,c as j}from"./config.BZJ3FbET.js";import{r as a}from"./index.Be8AcK8B.js";const M=j.apiUrl;function z(r){return r.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/\s+/g,"-")}const X=()=>{const[r,p]=a.useState([]),[y,g]=a.useState(!0),[o,N]=a.useState(!1),[w,i]=a.useState(0),l=a.useRef(null),m=a.useRef(null),u=a.useRef(null),d=a.useRef(0),x=a.useRef(!1),f=a.useRef(null),h=a.useRef(null);a.useEffect(()=>{(async()=>{g(!0);try{const s=await fetch($(j.endpoints.productos.list));if(!s.ok)throw new Error(`Error HTTP ${s.status}`);const c=await s.json(),k=Array.isArray(c)?c.slice(-6):Array.isArray(c.data)?c.data.slice(-6):[];p(k)}catch(s){console.error("Error al obtener productos:",s),p([])}finally{g(!1)}})();const n=()=>N(window.innerWidth<1024);return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]),a.useEffect(()=>{if(!(!o||r.length===0))return l.current&&window.clearInterval(l.current),l.current=window.setInterval(()=>{i(e=>(e+1)%r.length)},4200),()=>{l.current&&(window.clearInterval(l.current),l.current=null)}},[o,r.length]),a.useEffect(()=>{if(o||!m.current||r.length===0)return;const e=m.current,n=.45;d.current=0;const s=()=>{if(!x.current){const c=e.scrollWidth/2;d.current-=n,Math.abs(d.current)>=c&&(d.current=0),e.style.transform=`translateX(${d.current}px)`}u.current=requestAnimationFrame(s)};return u.current=requestAnimationFrame(s),()=>{u.current&&cancelAnimationFrame(u.current),u.current=null}},[o,r]);const I=()=>{o||(x.current=!0)},E=()=>{o||(x.current=!1)},R=e=>{o&&(l.current&&(window.clearInterval(l.current),l.current=null),f.current=e.touches[0].clientX)},A=e=>{o&&(h.current=e.touches[0].clientX)},S=()=>{if(!o)return;if(f.current==null||h.current==null){l.current||(l.current=window.setInterval(()=>{i(s=>(s+1)%r.length)},4200)),f.current=null,h.current=null;return}const e=f.current-h.current;Math.abs(e)>50&&(e>0?i(s=>(s+1)%r.length):i(s=>(s-1+r.length)%r.length)),f.current=null,h.current=null,l.current||(l.current=window.setInterval(()=>{i(s=>(s+1)%r.length)},4200))},b=e=>{const n=e.imagenes?.[0]?.url_imagen;return typeof n=="string"?n.startsWith("http")?n:`${M.replace(/\/$/,"")}${n}`:`https://placehold.co/300x300/orange/white?text=${encodeURIComponent(e.titulo??"Producto")}`},v=e=>`/productos/${e.link??z(String(e.titulo))}`;return y?t.jsxs("div",{className:"w-full flex justify-center items-center h-48",children:[t.jsx("div",{className:"animate-spin rounded-full h-9 w-9 border-t-2 border-b-2 border-white mr-3"}),t.jsx("span",{className:"text-white font-medium",children:"Cargando productos..."})]}):r.length?o?t.jsxs("div",{className:"relative w-full overflow-hidden",onTouchStart:R,onTouchMove:A,onTouchEnd:S,"aria-label":"Carrusel productos destacado - mÃ³vil",children:[t.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-12 bg-gradient-to-r from-[#2A938B]/35 to-transparent z-20 pointer-events-none"}),t.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-12 bg-gradient-to-l from-[#2A938B]/35 to-transparent z-20 pointer-events-none"}),t.jsx("div",{className:"flex transition-transform duration-500 ease-in-out",style:{transform:`translateX(-${w*100}%)`},children:r.map(e=>t.jsx("div",{className:"flex-shrink-0 w-full px-4 flex justify-center",children:t.jsx("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg w-full max-w-[320px]",children:t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:b(e),alt:String(e.titulo),title:String(e.titulo),className:"w-full h-80 object-cover",loading:"lazy"}),t.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-white/85 backdrop-blur-sm flex items-center justify-between px-4 py-3",children:[t.jsx("h3",{className:"text-teal-700 font-bold text-sm uppercase truncate flex-1",children:e.titulo}),t.jsx("a",{href:v(e),className:"bg-white border-2 border-teal-700 text-teal-700 hover:bg-teal-700 hover:text-white px-3 py-1 rounded-md font-semibold text-xs transition-all ml-2 whitespace-nowrap",children:"Comprar"})]})]})})},e.id))}),t.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 flex gap-2 z-30",style:{bottom:2},children:r.map((e,n)=>t.jsx("button",{onClick:()=>{i(n),l.current&&(window.clearInterval(l.current),l.current=window.setInterval(()=>{i(s=>(s+1)%r.length)},4200))},"aria-label":`Ir al producto ${n+1}`,className:`rounded-full transition-all ${n===w?"bg-teal-700 w-6 h-2":"bg-gray-400 w-2 h-2"}`},n))})]}):t.jsxs("div",{className:"relative w-full overflow-hidden","aria-label":"Carrusel productos destacado - desktop",onMouseEnter:I,onMouseLeave:E,children:[t.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-36 pointer-events-none z-30",style:{background:"linear-gradient(90deg, rgba(2,78,75,0.95) 0%, rgba(42,147,139,0.45) 35%, rgba(42,147,139,0.15) 60%, transparent 100%)"}}),t.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-36 pointer-events-none z-30",style:{background:"linear-gradient(270deg, rgba(13,45,43,0.85) 0%, rgba(13,45,43,0.35) 35%, rgba(13,45,43,0.12) 60%, transparent 100%)"}}),t.jsx("div",{ref:m,className:"flex gap-6 will-change-transform",children:[...r,...r].map((e,n)=>t.jsx("div",{className:"flex-shrink-0 w-1/3 px-3",children:t.jsx("div",{className:"bg-white rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-500",children:t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:b(e),alt:String(e.titulo),title:String(e.titulo),className:"w-full h-80 object-cover",loading:"lazy"}),t.jsxs("div",{className:"absolute inset-x-0 bottom-0 bg-white/85 backdrop-blur-sm flex items-center justify-between px-4 py-3",children:[t.jsx("h3",{className:"text-teal-700 font-bold text-sm uppercase truncate flex-1",children:e.titulo}),t.jsx("a",{href:v(e),className:"bg-white border-2 border-teal-700 text-teal-700 hover:bg-teal-700 hover:text-white px-3 py-1 rounded-md font-semibold text-xs transition-all ml-2 whitespace-nowrap",children:"Comprar"})]})]})})},`${e.id}-${n}`))})]}):null};export{X as default};
