import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as i}from"./index.DtoOFyvK.js";import{g as B,c as $}from"./config.BD8tWXmp.js";import{G as R,a as U,b as W,F as K,c as V,d as J}from"./index.BUtwrFzd.js";import{S as u}from"./sweetalert2.esm.all.CH_YVA8w.js";function H(l){return R({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z"},child:[]}]})(l)}async function z(){try{const l=localStorage.getItem("token"),f=B($.endpoints.productos.list),c=await fetch(f,{method:"GET",headers:{Accept:"application/json",Authorization:`Bearer ${l}`}});if(!c.ok)throw new Error("Error al obtener productos");return await c.json()}catch(l){console.error("Error al obtener productos:",l)}}async function Q(l){try{const f=localStorage.getItem("token");return(await fetch(B($.endpoints.productos.delete(l)),{method:"DELETE",headers:{Authorization:`Bearer ${f}`,Accept:"application/json"}})).ok?"✅ Producto eliminado exitosamente":"❌ Error al eliminar el producto"}catch(f){return`Error al obtener productos: 
 ${f}`}}function G(l){return l.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}const X=({product:l,onProductUpdated:f})=>{const[c,x]=i.useState(!1),[w,b]=i.useState(!1),[g,j]=i.useState(1),[m,_]=i.useState(!1),[v,o]=i.useState([]),[r,d]=i.useState({nombre:"",titulo:"",subtitulo:"",link:"",descripcion:"",stock:100,precio:199.99,seccion:"Trabajo",especificaciones:{Alto:"",Largo:"",Ancho:""},etiqueta:{meta_titulo:"",meta_descripcion:""},relacionados:[],imagenes:[{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""}],textos_alt:[]}),k=t=>{d({...r,[t.target.name]:t.target.value})},L=(t,s)=>{t.target.checked?d({...r,relacionados:[...r.relacionados,s]}):d({...r,relacionados:r.relacionados.filter(a=>a!==s)})},q=(t,s)=>{const a=t.target.files?.[0];if(!a)return;const p=[...r.imagenes];p[s]={...p[s],url_imagen:a},d(O=>({...O,imagenes:p}))},E=(t,s)=>{if(t.target.value){const a=[...r.imagenes];a[s]={...a[s],texto_alt_SEO:t.target.value},d({...r,imagenes:a})}},N=i.useRef(null);function M(){b(!0)}function A(){j(1),b(!1),d({nombre:"",titulo:"",subtitulo:"",link:"",descripcion:"",stock:100,precio:199.99,seccion:"Trabajo",especificaciones:{Alto:"",Largo:"",Ancho:""},etiqueta:{meta_titulo:"",meta_descripcion:""},relacionados:[],imagenes:[{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""}],textos_alt:[]})}function n(){_(!0),setTimeout(()=>{j(t=>t+1),_(!1),C()},500)}function h(){_(!0),setTimeout(()=>{j(t=>t-1),_(!1),C()},500)}function C(){N.current&&N.current.scrollTo({top:0,behavior:"smooth"})}function P(t){return t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}const F=()=>{const t=prompt("Nombre de la nueva especificación:");if(t){const s=P(t.trim());r.especificaciones[s]||d(a=>({...a,especificaciones:{...a.especificaciones,[s]:""}}))}},I=async t=>{if(t.preventDefault(),x(!0),!r.nombre||!r.titulo||!r.subtitulo||!r.descripcion||!r.seccion||!r.imagenes||r.imagenes.some(s=>!s.url_imagen)){console.log("⚠️ Validación fallida. Campos faltantes:"),r.nombre||console.log("→ Falta: nombre"),r.titulo||console.log("→ Falta: titulo"),r.subtitulo||console.log("→ Falta: subtitulo"),r.descripcion||console.log("→ Falta: descripcion"),r.seccion||console.log("→ Falta: seccion"),r.imagenes.forEach((s,a)=>{s.url_imagen||console.log(`→ Falta: imagen[${a}]`)}),u.fire({icon:"warning",title:"Campos obligatorios",text:"⚠️ Todos los campos generales son obligatorios."}),x(!1);return}if(!r.especificaciones?.Ancho?.trim()||!r.especificaciones?.Alto?.trim()||!r.especificaciones?.Largo?.trim()){u.fire({icon:"warning",title:"Dimensiones incompletas",text:"⚠️ Debes completar las dimensiones: Ancho, Alto y Largo."}),x(!1);return}if(!r.etiqueta.meta_titulo.trim()||r.etiqueta.meta_titulo.length<10||r.etiqueta.meta_titulo.length>70){u.fire({icon:"warning",title:"Meta título inválido",text:"⚠️ El meta título debe tener entre 10 y 70 caracteres."}),x(!1);return}if(!r.etiqueta.meta_descripcion.trim()||r.etiqueta.meta_descripcion.length<50||r.etiqueta.meta_descripcion.length>200){u.fire({icon:"warning",title:"Meta descripción inválida",text:"⚠️ La meta descripción debe tener entre 50 y 200 caracteres."}),x(!1);return}try{const s=localStorage.getItem("token"),a=new FormData;a.append("nombre",r.nombre),a.append("titulo",r.titulo),a.append("subtitulo",r.subtitulo);const p=G(r.titulo||r.nombre);a.append("link",p),a.append("descripcion",r.descripcion),a.append("stock",r.stock.toString()),a.append("precio",r.precio.toString()),a.append("seccion",r.seccion),a.append("especificaciones",JSON.stringify(r.especificaciones)),a.append("etiqueta[meta_titulo]",r.etiqueta.meta_titulo),a.append("etiqueta[meta_descripcion]",r.etiqueta.meta_descripcion),r.imagenes.forEach((y,S)=>{const D=y.texto_alt_SEO.trim()||"Texto SEO para imagen";y.url_imagen instanceof File&&a.append(`imagenes[${S}]`,y.url_imagen),a.append(`textos_alt[${S}]`,D)}),r.relacionados.forEach((y,S)=>{a.append(`relacionados[${S}]`,y.toString())}),a.append("_method","PUT");const O=await fetch(B($.endpoints.productos.update(l.id)),{method:"POST",body:a,headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}}),T=await O.json();console.log("Respuesta del servidor:",T),O.ok?(u.fire({icon:"success",title:"Producto actualizado exitosamente",showConfirmButton:!1,timer:1500}),A(),await f?.(),x(!1)):(u.fire({icon:"error",title:"Error",text:T.message}),x(!1))}catch(s){console.error("Error al enviar los datos:",s),u.fire({icon:"error",title:"Error",text:`❌ Error: ${s}`}),x(!1)}};return i.useEffect(()=>{w&&(async()=>{try{const s=await z();o(s)}catch(s){console.error("Error al obtener productos:",s)}})()},[w]),i.useEffect(()=>{if(w&&l){const t=l.imagenes?.map(a=>({url_imagen:`https://apitami.tamimaquinarias.com${a.url_imagen}`,texto_alt_SEO:a.texto_alt_SEO}))||[],s=l.productos_relacionados?.map(a=>a.id)||[];d({nombre:l.nombre,titulo:l.titulo,subtitulo:l.subtitulo,link:l.link,descripcion:l.descripcion,etiqueta:{meta_titulo:l.etiqueta?.meta_titulo||"",meta_descripcion:l.etiqueta?.meta_descripcion||""},stock:l.stock,precio:l.precio,seccion:l.seccion,especificaciones:l.especificaciones||{Alto:"",Largo:"",Ancho:""},relacionados:s,imagenes:t.length>0?t:[{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""}],textos_alt:l.imagenes?.map(a=>a.texto_alt_SEO)||[]})}},[w,l]),e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"p-2 text-green-600 hover:text-green-800 transition hover:cursor-pointer",title:"Editar",onClick:M,children:e.jsx(U,{size:18})}),w&&e.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex justify-center items-center p-4 md:p-6 lg:p-8 overflow-y-auto",children:[e.jsx("button",{className:"absolute top-4 right-4 md:top-6 md:right-6 text-white hover:text-red-400 transition-all duration-300 hover:cursor-pointer text-3xl md:text-4xl",onClick:()=>A(),"aria-label":"Cerrar",children:e.jsx(H,{})}),e.jsxs("div",{ref:N,className:"bg-white w-full max-w-md md:max-w-2xl lg:max-w-4xl rounded-2xl shadow-2xl p-6 md:p-8 relative transition-all duration-500 overflow-y-auto max-h-[90vh] min-h-[70vh] md:min-h-[80vh]",children:[e.jsx("div",{className:"bg-teal-600 -mx-6 md:-mx-8 -mt-6 md:-mt-8 mb-6 p-4 md:p-6 rounded-t-2xl",children:e.jsx("h4",{className:"text-xl md:text-2xl text-center font-bold text-white",children:"Editar Producto"})}),e.jsxs("form",{onSubmit:I,className:"relative",children:[e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${m&&g===1?"-translate-x-full opacity-0 pointer-events-none":""} ${!m&&g===1?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Nombre:"}),e.jsx("input",{required:!0,value:r.nombre,onChange:k,type:"text",name:"nombre",placeholder:"Nombre del producto...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Descripción:"}),e.jsx("textarea",{required:!0,value:r.descripcion,onChange:k,name:"descripcion",placeholder:"Descripción del producto...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition min-h-[100px]"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"meta_titulo",className:"block font-medium text-sm text-gray-700",children:["Meta título ",e.jsx("span",{className:"text-gray-500",children:"(recomendado: 50-60 caracteres)"})]}),e.jsx("input",{type:"text",id:"meta_titulo",name:"meta_titulo",value:r.etiqueta.meta_titulo,onChange:t=>d(s=>({...s,etiqueta:{...s.etiqueta,meta_titulo:t.target.value}})),maxLength:70,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.etiqueta.meta_titulo.length," / 70 caracteres"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"meta_descripcion",className:"block font-medium text-sm text-gray-700",children:["Meta descripción ",e.jsx("span",{className:"text-gray-500",children:"(recomendado: 40-160 caracteres)"})]}),e.jsx("textarea",{id:"meta_descripcion",name:"meta_descripcion",value:r.etiqueta.meta_descripcion,onChange:t=>d(s=>({...s,etiqueta:{...s.etiqueta,meta_descripcion:t.target.value}})),maxLength:200,rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.etiqueta.meta_descripcion.length," / 200 caracteres"]})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Título:"}),e.jsx("input",{required:!0,value:r.titulo,onChange:k,type:"text",name:"titulo",placeholder:"Título...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Subtitulo:"}),e.jsx("input",{required:!0,value:r.subtitulo??"",onChange:k,type:"text",name:"subtitulo",placeholder:"Subtitulo...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Sección del Producto:"}),e.jsxs("select",{required:!0,value:r.seccion,onChange:k,name:"seccion",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition appearance-none bg-white",children:[e.jsx("option",{value:"Trabajo",children:"Trabajo"}),e.jsx("option",{value:"Decoración",children:"Decoración"}),e.jsx("option",{value:"Negocio",children:"Negocio"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100 mb-4",children:[e.jsx("h5",{className:"font-medium !text-gray-700 mb-3",children:"Dimensiones"}),e.jsx("div",{className:"space-y-3",children:["Alto","Largo","Ancho"].map(t=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("label",{className:"text-sm text-gray-600 sm:w-1/4",children:[t,":"]}),e.jsx("input",{type:"text",name:t,value:r.especificaciones[t]||"",onChange:s=>d(a=>({...a,especificaciones:{...a.especificaciones,[t]:s.target.value}})),required:!0,className:`flex-1 px-4 py-2 border border-gray-300 rounded-lg
           focus:ring-2 focus:ring-teal-500 focus:border-transparent
           outline-none transition text-sm`})]},t))})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:[e.jsx("h5",{className:"font-medium !text-gray-700 mb-3",children:"Especificaciones"}),e.jsx("div",{className:"space-y-3",children:Object.entries(r.especificaciones).filter(([t])=>!["Alto","Largo","Ancho"].includes(t)).map(([t,s])=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("label",{className:"text-sm text-gray-600 sm:w-1/4",children:[t,":"]}),e.jsx("input",{type:"text",name:t,value:s,onChange:a=>d(p=>({...p,especificaciones:{...p.especificaciones,[t]:a.target.value}})),className:`flex-1 px-4 py-2 border border-gray-300 rounded-lg
             focus:ring-2 focus:ring-teal-500 focus:border-transparent
             outline-none transition text-sm`})]},t))}),e.jsxs("button",{type:"button",onClick:F,className:`mt-3 inline-flex items-center gap-1 bg-teal-50 hover:bg-teal-100
     text-teal-700 px-3 py-2 rounded-lg text-sm font-medium transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Añadir Especificación"]})]})]}),e.jsxs("button",{onClick:n,className:"mt-6 mb-4 w-full bg-teal-600 hover:bg-teal-700 text-white py-3 px-6 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2",type:"button",children:["Siguiente",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${m&&g===2?"-translate-x-full opacity-0 pointer-events-none":""} ${!m&&g===2?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100 mb-6",children:[e.jsx("h5",{className:"font-medium !text-gray-700 mb-4",children:"Galería de Imágenes"}),e.jsx("div",{className:"space-y-4",children:r.imagenes.map((t,s)=>e.jsxs("div",{className:"form-input",children:[e.jsxs("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:["Imagen ",s+1,":"]}),e.jsx("div",{className:"border border-dashed border-gray-300 rounded-lg p-4 bg-white",children:t.url_imagen?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:typeof t.url_imagen=="string"?t.url_imagen.startsWith("http")?t.url_imagen:`https://apitami.tamimaquinarias.com${t.url_imagen}`:URL.createObjectURL(t.url_imagen),alt:t.texto_alt_SEO||`Imagen ${s+1}`,className:"w-16 h-16 object-cover rounded border-2 border-gray-200"}),e.jsxs("label",{className:"text-sm text-blue-600 underline cursor-pointer",children:["Reemplazar",e.jsx("input",{type:"file",accept:"image/*",onChange:a=>q(a,s),className:"hidden"})]}),e.jsx("p",{children:"* Obligatorio"})]}):e.jsx("input",{required:!0,type:"file",accept:"image/*",onChange:a=>q(a,s),className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"})}),e.jsxs("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:["Texto SEO Imagen ",s+1,":"]}),e.jsx("div",{className:"border border-dashed border-gray-300 rounded-lg p-4 bg-white",children:e.jsx("input",{required:!0,type:"text",onChange:a=>E(a,s),value:t.texto_alt_SEO?t.texto_alt_SEO:"",className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"})})]},s))})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3",children:[e.jsxs("button",{onClick:h,className:"w-full sm:w-1/2 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 px-6 rounded-lg font-medium transition-all duration-300 flex items-center justify-center gap-2",type:"button",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Volver"]}),e.jsxs("button",{type:"button",onClick:n,className:"w-full sm:w-1/2 bg-teal-600 hover:bg-teal-700 text-white py-3 px-6 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2",children:["Siguiente",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${m&&g===3?"-translate-x-full opacity-0 pointer-events-none":""} ${!m&&g===3?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"form-input mb-6",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-3",children:"Productos Relacionados:"}),v.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 max-h-64 overflow-y-auto p-2 bg-gray-50 rounded-lg border border-gray-100",children:v.map(t=>e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsxs("label",{className:"cursor-pointer group relative",children:[e.jsx("input",{type:"checkbox",className:"peer absolute opacity-0",value:t.id,checked:r.relacionados.includes(t.id),onChange:s=>L(s,t.id)}),e.jsxs("div",{className:"relative",children:[t.imagenes?.[0]?.url_imagen?e.jsx("img",{src:`https://apitami.tamimaquinarias.com${t.imagenes[0].url_imagen}`,alt:t.nombre,className:`w-24 h-24 md:w-28 md:h-28 object-cover rounded-xl border-2 transition-all duration-300 ${r.relacionados.includes(t.id)?"border-teal-600":"border-gray-200 group-hover:border-teal-400"}`}):e.jsx("span",{className:"text-sm text-gray-400 italic",children:"Sin imagen"}),e.jsx("div",{className:"absolute inset-0 bg-teal-600/0 peer-checked:bg-teal-600/20 flex items-center justify-center rounded-xl transition-all duration-300",children:e.jsx("svg",{className:"w-8 h-8 text-white opacity-0 peer-checked:opacity-100 transition-all duration-300",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),e.jsx("p",{className:"text-xs text-center mt-1 text-gray-600",children:t.nombre})]})},t.id))}):e.jsx("div",{className:"flex items-center justify-center h-40 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block p-3 rounded-full bg-gray-100 mb-2",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cargando productos..."})]})})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3",children:[e.jsxs("button",{onClick:h,className:"w-full sm:w-1/2 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 px-6 rounded-lg font-medium transition-all duration-300 flex items-center justify-center gap-2",type:"button",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Volver"]}),e.jsx("button",{disabled:c,type:"submit",className:`w-full sm:w-1/2 bg-teal-600 hover:bg-teal-700 text-white py-3 px-6 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 ${c?"opacity-75 cursor-not-allowed":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("span",{children:"Guardando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Guardar Producto"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})})]})]})]})]})]})]})};function Y(l){return R({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"},child:[]}]})(l)}const Z=({onProductAdded:l})=>{const[f,c]=i.useState(!1),[x,w]=i.useState(!1),[b,g]=i.useState(1),[j,m]=i.useState(!1),[_,v]=i.useState([]),[o,r]=i.useState({nombre:"",titulo:"",subtitulo:"",descripcion:"",link:"",stock:100,precio:199.99,seccion:"Negocio",especificaciones:{Alto:"",Largo:"",Ancho:""},etiqueta:{meta_titulo:"",meta_descripcion:""},relacionados:[],imagenes:[{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""}],textos_alt:[]}),d=t=>{r({...o,[t.target.name]:t.target.value})},k=(t,s)=>{t.target.checked?r({...o,relacionados:[...o.relacionados,s]}):r({...o,relacionados:o.relacionados.filter(a=>a!==s)})},L=(t,s)=>{if(t.target.files&&t.target.files[0]){const a=[...o.imagenes];a[s]={...a[s],url_imagen:t.target.files[0]},r({...o,imagenes:a})}},q=(t,s)=>{if(t.target.value){const a=[...o.imagenes];a[s]={...a[s],texto_alt_SEO:t.target.value},r({...o,imagenes:a})}},E=i.useRef(null);function N(){w(!0)}function M(){g(1),w(!1),r({nombre:"",titulo:"",subtitulo:"",descripcion:"",link:"",stock:100,precio:199.99,seccion:"Negocio",especificaciones:{Alto:"",Largo:"",Ancho:""},etiqueta:{meta_titulo:"",meta_descripcion:""},relacionados:[],imagenes:[{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""},{url_imagen:null,texto_alt_SEO:""}],textos_alt:[]})}function A(){m(!0),setTimeout(()=>{g(t=>t+1),m(!1),h()},500)}function n(){m(!0),setTimeout(()=>{g(t=>t-1),m(!1),h()},500)}function h(){E.current&&E.current.scrollTo({top:0,behavior:"smooth"})}function C(t){return t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}const P={};Object.entries(o.especificaciones).forEach(([t,s])=>{const a=t.trim(),p=s.trim();a?P[C(a)]=p:P[""]=p});const F=()=>{const t=prompt("Nombre de la nueva especificación:");if(t){const s=C(t.trim());o.especificaciones[s]||r(a=>({...a,especificaciones:{...a.especificaciones,[s]:""}}))}},I=async t=>{if(t.preventDefault(),c(!0),!o.nombre||!o.titulo||!o.subtitulo||!o.descripcion||!o.seccion||!o.imagenes||o.imagenes.some(s=>!s.url_imagen)){u.fire({icon:"warning",title:"Campos obligatorios",text:"⚠️ Todos los campos generales son obligatorios."}),c(!1);return}if(!o.especificaciones?.Ancho?.trim()||!o.especificaciones?.Alto?.trim()||!o.especificaciones?.Largo?.trim()){u.fire({icon:"warning",title:"Dimensiones incompletas",text:"⚠️ Debes completar las especificaciones: Ancho, Alto y Largo."}),c(!1);return}if(!o.etiqueta.meta_titulo.trim()||o.etiqueta.meta_titulo.length<10||o.etiqueta.meta_titulo.length>70){u.fire({icon:"warning",title:"Meta título inválido",text:"⚠️ El meta título debe tener entre 10 y 70 caracteres."}),c(!1);return}if(!o.etiqueta.meta_descripcion.trim()||o.etiqueta.meta_descripcion.length<50||o.etiqueta.meta_descripcion.length>200){u.fire({icon:"warning",title:"Meta descripción inválida",text:"⚠️ La meta descripción debe tener entre 50 y 200 caracteres."}),c(!1);return}try{const s=localStorage.getItem("token"),a=new FormData;a.append("nombre",o.nombre),a.append("titulo",o.titulo),a.append("subtitulo",o.subtitulo),a.append("descripcion",o.descripcion),a.append("link",o.link),a.append("stock",o.stock.toString()),a.append("precio",o.precio.toString()),a.append("seccion",o.seccion),a.append("especificaciones",JSON.stringify(P)),a.append("etiqueta[meta_titulo]",o.etiqueta.meta_titulo),a.append("etiqueta[meta_descripcion]",o.etiqueta.meta_descripcion);const p=G(o.titulo||o.nombre);a.append("link",p),o.imagenes.forEach((y,S)=>{const D=y.texto_alt_SEO.trim()||"Texto SEO para imagen";y.url_imagen&&(a.append(`imagenes[${S}]`,y.url_imagen),a.append(`textos_alt[${S}]`,D))}),o.relacionados.forEach((y,S)=>{a.append(`relacionados[${S}]`,y.toString())});const O=await fetch(B($.endpoints.productos.create),{method:"POST",body:a,headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}}),T=await O.json();console.log("Respuesta del servidor:",T),O.ok?(u.fire({icon:"success",title:"Producto añadido exitosamente",showConfirmButton:!1,timer:1500}),M(),c(!1),l?.()):(u.fire({icon:"error",title:"Error",text:T.message}),c(!1))}catch(s){console.error("Error al enviar los datos:",s),u.fire({icon:"error",title:"Error",text:`❌ Error: ${s}`}),c(!1)}};return i.useEffect(()=>{x&&(async()=>{try{const s=await z();v(s)}catch(s){console.error("Error al obtener productos:",s)}})()},[x]),e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-teal-600 text-white hover:bg-teal-700 transition-all duration-300 px-5 py-3 rounded-lg text-sm font-bold shadow-lg hover:shadow-xl",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Agregar Producto"]}),x&&e.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex justify-center items-center p-4 md:p-6 lg:p-8 overflow-y-auto",children:[e.jsx("button",{className:"absolute top-4 right-4 md:top-6 md:right-6 text-white hover:text-red-400 transition-all duration-300 hover:cursor-pointer text-3xl md:text-4xl",onClick:()=>M(),"aria-label":"Cerrar",children:e.jsx(H,{})}),e.jsxs("div",{ref:E,className:"bg-white w-full max-w-md md:max-w-2xl lg:max-w-4xl rounded-2xl shadow-2xl p-6 md:p-8 relative transition-all duration-500 overflow-y-auto max-h-[90vh] min-h-[70vh] md:min-h-[80vh]",children:[e.jsx("div",{className:"bg-teal-600 -mx-6 md:-mx-8 -mt-6 md:-mt-8 mb-6 p-4 md:p-6 rounded-t-2xl",children:e.jsx("h4",{className:"text-xl md:text-2xl text-center font-bold text-white",children:"Agregar Producto"})}),e.jsxs("form",{onSubmit:I,className:"relative",children:[e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${j&&b===1?"-translate-x-full opacity-0 pointer-events-none":""} ${!j&&b===1?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Nombre:"}),e.jsx("input",{required:!0,value:o.nombre,onChange:d,type:"text",name:"nombre",placeholder:"Nombre del producto...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Descripción:"}),e.jsx("textarea",{required:!0,value:o.descripcion,onChange:d,name:"descripcion",placeholder:"Descripción del producto...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition min-h-[100px]"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"meta_titulo",className:"block font-medium text-sm text-gray-700",children:["Meta título ",e.jsx("span",{className:"text-gray-500",children:"(recomendado: 50-60 caracteres)"})]}),e.jsx("input",{type:"text",id:"meta_titulo",name:"meta_titulo",value:o.etiqueta.meta_titulo,onChange:t=>r(s=>({...s,etiqueta:{...s.etiqueta,meta_titulo:t.target.value}})),maxLength:70,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[o.etiqueta.meta_titulo.length," / 70 caracteres"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{htmlFor:"meta_descripcion",className:"block font-medium text-sm text-gray-700",children:["Meta descripción ",e.jsx("span",{className:"text-gray-500",children:"(recomendado: 40-160 caracteres)"})]}),e.jsx("textarea",{id:"meta_descripcion",name:"meta_descripcion",value:o.etiqueta.meta_descripcion,onChange:t=>r(s=>({...s,etiqueta:{...s.etiqueta,meta_descripcion:t.target.value}})),maxLength:200,rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[o.etiqueta.meta_descripcion.length," / 200 caracteres"]})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Título:"}),e.jsx("input",{required:!0,value:o.titulo,onChange:d,type:"text",name:"titulo",placeholder:"Título...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Subtitulo:"}),e.jsx("input",{required:!0,value:o.subtitulo,onChange:d,type:"text",name:"subtitulo",placeholder:"Subtitulo...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:"Sección del Producto:"}),e.jsxs("select",{required:!0,value:o.seccion,onChange:d,name:"seccion",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent outline-none transition appearance-none bg-white",children:[e.jsx("option",{value:"Negocio",children:"Negocio"}),e.jsx("option",{value:"Decoración",children:"Decoración"}),e.jsx("option",{value:"Maquinaria",children:"Maquinaria"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100 mb-4",children:[e.jsx("h5",{className:"font-medium !text-gray-700 mb-3",children:"Dimensiones"}),e.jsx("div",{className:"space-y-3",children:["Alto","Largo","Ancho"].map(t=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("label",{className:"text-sm text-gray-600 sm:w-1/4",children:[t,":"]}),e.jsx("input",{type:"text",name:t,value:o.especificaciones[t]||"",onChange:s=>r(a=>({...a,especificaciones:{...a.especificaciones,[t]:s.target.value}})),required:!0,className:`flex-1 px-4 py-2 border border-gray-300 rounded-lg
                     focus:ring-2 focus:ring-teal-500 focus:border-transparent
                     outline-none transition text-sm`})]},t))})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100",children:[e.jsx("h5",{className:"font-medium !text-gray-700 mb-3",children:"Especificaciones"}),e.jsx("div",{className:"space-y-3",children:Object.entries(o.especificaciones).filter(([t])=>!["Alto","Largo","Ancho"].includes(t)).map(([t,s])=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsxs("label",{className:"text-sm text-gray-600 sm:w-1/4",children:[t,":"]}),e.jsx("input",{type:"text",name:t,value:s,onChange:a=>r(p=>({...p,especificaciones:{...p.especificaciones,[t]:a.target.value}})),className:`flex-1 px-4 py-2 border border-gray-300 rounded-lg
                       focus:ring-2 focus:ring-teal-500 focus:border-transparent
                       outline-none transition text-sm`})]},t))}),e.jsxs("button",{type:"button",onClick:F,className:`mt-3 inline-flex items-center gap-1 bg-teal-50 hover:bg-teal-100
               text-teal-700 px-3 py-2 rounded-lg text-sm font-medium transition-colors`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Añadir Especificación"]})]})]}),e.jsxs("button",{onClick:A,className:"mt-6 mb-4 w-full bg-teal-600 hover:bg-teal-700 text-white py-3 px-6 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2",type:"button",children:["Siguiente",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${j&&b===2?"-translate-x-full opacity-0 pointer-events-none":""} ${!j&&b===2?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-100 mb-6",children:[e.jsx("h5",{className:"font-medium !text-gray-700 mb-4",children:"Galería de Imágenes"}),e.jsx("div",{className:"space-y-4",children:o.imagenes.map((t,s)=>e.jsxs("div",{className:"form-input",children:[e.jsxs("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:["Imagen ",s+1,":"]}),e.jsx("div",{className:"border border-dashed border-gray-300 rounded-lg p-4 bg-white",children:e.jsx("input",{required:!0,type:"file",accept:"image/*",onChange:a=>L(a,s),className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"})}),e.jsxs("label",{className:"block !text-gray-700 text-sm font-medium mb-1",children:["Texto SEO Imagen ",s+1,":"]}),e.jsx("div",{className:"border border-dashed border-gray-300 rounded-lg p-4 bg-white",children:e.jsx("input",{required:!0,type:"text",onChange:a=>q(a,s),className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100"})})]},s))})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3",children:[e.jsxs("button",{onClick:n,className:"w-full sm:w-1/2 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 px-6 rounded-lg font-medium transition-all duration-300 flex items-center justify-center gap-2",type:"button",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Volver"]}),e.jsxs("button",{type:"button",onClick:A,className:"w-full sm:w-1/2 bg-teal-600 hover:bg-teal-700 text-white py-3 px-6 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2",children:["Siguiente",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]})]}),e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${j&&b===3?"-translate-x-full opacity-0 pointer-events-none":""} ${!j&&b===3?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"form-input mb-6",children:[e.jsx("label",{className:"block !text-gray-700 text-sm font-medium mb-3",children:"Productos Relacionados:"}),_.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 max-h-64 overflow-y-auto p-2 bg-gray-50 rounded-lg border border-gray-100",children:_.map(t=>e.jsx("div",{className:"flex flex-col items-center gap-2",children:e.jsxs("label",{className:"cursor-pointer group relative",children:[e.jsx("input",{type:"checkbox",className:"peer absolute opacity-0",value:t.id,onChange:s=>k(s,t.id)}),e.jsxs("div",{className:"relative",children:[t.imagenes?.[0]?.url_imagen?e.jsx("img",{src:`https://apitami.tamimaquinarias.com${t.imagenes[0].url_imagen}`,alt:t.nombre,className:`w-24 h-24 md:w-28 md:h-28 object-cover rounded-xl border-2 transition-all duration-300 ${o.relacionados.includes(t.id)?"border-teal-600":"border-gray-200 group-hover:border-teal-400"}`}):e.jsx("span",{className:"text-sm text-gray-400 italic",children:"Sin imagen"}),e.jsx("div",{className:"absolute inset-0 bg-teal-600/0 peer-checked:bg-teal-600/20 flex items-center justify-center rounded-xl transition-all duration-300",children:e.jsx("svg",{className:"w-8 h-8 text-white opacity-0 peer-checked:opacity-100 transition-all duration-300",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})})})]}),e.jsx("p",{className:"text-xs text-center mt-1 text-gray-600",children:t.nombre})]})},t.id))}):e.jsx("div",{className:"flex items-center justify-center h-40 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block p-3 rounded-full bg-gray-100 mb-2",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400 animate-pulse",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Cargando productos..."})]})})]}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3",children:[e.jsxs("button",{onClick:n,className:"w-full sm:w-1/2 bg-gray-200 hover:bg-gray-300 text-gray-800 py-3 px-6 rounded-lg font-medium transition-all duration-300 flex items-center justify-center gap-2",type:"button",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Volver"]}),e.jsx("button",{disabled:f,type:"submit",className:`w-full sm:w-1/2 bg-teal-600 hover:bg-teal-700 text-white py-3 px-6 rounded-lg font-medium shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center gap-2 ${f?"opacity-75 cursor-not-allowed":""}`,children:f?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),e.jsx("span",{children:"Guardando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Guardar Producto"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})})]})]})]})]})]})]})},ee=$.apiUrl,ne=()=>{const[l,f]=i.useState([]),[c,x]=i.useState([]),[w,b]=i.useState(null),[g,j]=i.useState(!0),[m,_]=i.useState(""),[v,o]=i.useState(1),r=5,d=async()=>{j(!0);try{const n=await z();n&&(f(n),x(n))}catch(n){console.error("Error al obtener productos:",n),u.fire({icon:"error",title:"Error",text:"Hubo un error al cargar los productos",confirmButtonColor:"#14b8a6"})}finally{j(!1)}},k=n=>{u.fire({title:"¿Estás seguro?",text:"¡No podrás revertir esta acción!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#14b8a6",cancelButtonColor:"#ef4444",confirmButtonText:"Sí, eliminar",cancelButtonText:"Cancelar"}).then(h=>{h.isConfirmed&&(b(n),Q(n).then(C=>{C&&(u.fire({icon:"success",title:"Eliminado",text:"El producto ha sido eliminado correctamente",confirmButtonColor:"#14b8a6"}),b(null),d())}).catch(C=>{console.error("Error al eliminar producto:",C),u.fire({icon:"error",title:"Error",text:"Hubo un error al eliminar el producto",confirmButtonColor:"#14b8a6"}),b(null)}))})};i.useEffect(()=>{d()},[]),i.useEffect(()=>{if(m==="")x(l),o(1);else{const n=l.filter(h=>h.nombre.toLowerCase().includes(m.toLowerCase())||h.seccion.toLowerCase().includes(m.toLowerCase())||h.id.toString().includes(m));x(n),o(1)}},[m,l]);const L=v*r,q=L-r,E=c.slice(q,L),N=Math.ceil(c.length/r),M=()=>o(n=>Math.max(n-1,1)),A=()=>o(n=>Math.min(n+1,N));return e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100",children:[e.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-emerald-600 px-8 py-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-extrabold flex items-center gap-2 text-white",children:[e.jsx(W,{}),e.jsx("span",{children:"Gestión de Productos"})]}),e.jsx("p",{className:"text-teal-50 mt-2 text-lg",children:"Administra el catálogo de productos de tu empresa"})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Z,{onProductAdded:d})})]})}),e.jsxs("div",{className:"p-8 space-y-6 border-b border-gray-100 bg-white",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-center",children:[e.jsxs("div",{className:"relative w-full sm:w-80",children:[e.jsx(K,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-4 w-4 text-teal-500"}),e.jsx("input",{type:"text",placeholder:"Buscar productos...",className:"pl-10 w-full rounded-full border-2 border-teal-100 py-3 px-5 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent shadow-sm transition-all duration-300",value:m,onChange:n=>_(n.target.value)})]}),e.jsxs("button",{onClick:d,disabled:g,className:"flex items-center gap-2 bg-white text-teal-600 border-2 border-teal-500 hover:bg-teal-50 transition-all duration-300 px-5 py-3 rounded-full text-sm font-bold w-full sm:w-auto justify-center shadow-sm",children:[e.jsx(V,{className:`h-4 w-4 ${g?"animate-spin":""}`}),g?"Cargando...":"Actualizar Catálogo"]})]}),e.jsx("div",{className:"flex items-center justify-between bg-teal-50 p-4 rounded-xl border border-teal-100 shadow-sm",children:e.jsxs("div",{className:"text-sm font-medium text-teal-700 flex items-center gap-2",children:[e.jsx("span",{className:"bg-teal-500 text-white text-sm font-bold py-1 px-3 rounded-full",children:c.length}),c.length===1?"producto":"productos"," encontrados"]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-teal-50 text-teal-800",children:e.jsx("tr",{children:["ID","NOMBRE","SECCIÓN","IMAGEN","ACCIÓN"].map((n,h)=>e.jsx("th",{className:"px-6 py-4 text-left font-bold tracking-wide uppercase text-xs",children:n},h))})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:g?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-12",children:e.jsxs("div",{className:"flex justify-center items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-teal-500"}),e.jsx("span",{className:"text-teal-500 font-medium",children:"Cargando productos..."})]})})}):E.length>0?E.map((n,h)=>e.jsxs("tr",{className:"hover:bg-teal-50/50 transition-colors duration-200",children:[e.jsxs("td",{className:"px-6 py-4 font-medium whitespace-nowrap text-teal-700",children:["#",n.id]}),e.jsx("td",{className:"px-6 py-4 font-medium",children:n.nombre}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"bg-teal-100 text-teal-800 py-1 px-3 rounded-full text-xs capitalize font-medium",children:n.seccion?n.seccion.toLowerCase():"sin sección"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center",children:n.imagenes?.[0]?.url_imagen?e.jsx("img",{src:`${ee}${n.imagenes[0].url_imagen}`,alt:n.nombre,className:"w-14 h-14 object-cover rounded-lg shadow-md border border-gray-200"}):e.jsx("span",{className:"text-sm text-gray-400 italic",children:"Sin imagen"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsx(X,{product:n,onProductUpdated:d}),e.jsx("button",{className:"p-2 rounded-full hover:bg-red-100 text-red-500 transition-colors duration-200 border border-transparent hover:border-red-200",title:"Eliminar",onClick:()=>k(n.id),disabled:w===n.id,children:w===n.id?e.jsx(Y,{className:"animate-spin",size:18}):e.jsx(J,{size:18})})]})})]},n.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-16 text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx("div",{className:"bg-teal-50 p-6 rounded-full",children:e.jsx(W,{className:"h-10 w-10 text-teal-300"})}),e.jsx("p",{className:"text-xl font-medium text-gray-600 mt-4",children:m?"No se encontraron productos que coincidan con tu búsqueda":"No hay productos registrados"}),e.jsx("p",{className:"text-gray-400 max-w-md mx-auto",children:m?"Intenta con otros términos de búsqueda":"Comienza agregando productos a tu catálogo con el botón 'Agregar Producto'"})]})})})})]})}),c.length>r&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4 px-8 py-6 bg-teal-50/50 border-t border-teal-100",children:[e.jsxs("div",{className:"text-sm text-teal-700 font-medium",children:["Mostrando ",q+1,"-",Math.min(L,c.length)," de ",c.length," productos"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:M,disabled:v===1,className:`px-5 py-2 rounded-full text-sm font-bold transition-all duration-300 ${v===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-teal-500 text-white hover:bg-teal-600 shadow-md hover:shadow-lg"}`,children:"Anterior"}),e.jsxs("div",{className:"flex items-center justify-center px-4 py-2 bg-white border border-teal-200 rounded-full text-sm font-bold text-teal-700 shadow-sm",children:[v," de ",N]}),e.jsx("button",{onClick:A,disabled:v===N,className:`px-5 py-2 rounded-full text-sm font-bold transition-all duration-300 ${v===N?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-teal-500 text-white hover:bg-teal-600 shadow-md hover:shadow-lg"}`,children:"Siguiente"})]})]})]})})};export{ne as default};
