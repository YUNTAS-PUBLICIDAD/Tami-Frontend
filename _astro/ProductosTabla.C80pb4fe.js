import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as d}from"./index.BJfUAbRs.js";import{b as z,F as M}from"./index.CCB-2VsR.js";import{g as N,c as y}from"./config.BxIw3SrH.js";import{G as I}from"./iconBase.BO9dh9lf.js";const B=()=>e.jsx(e.Fragment,{children:e.jsx("button",{className:"p-2 text-green-600 hover:text-green-800 transition hover:cursor-pointer",title:"Editar",onClick:()=>{console.log("ola")},children:e.jsx(z,{size:18})})});async function T(){try{const r=localStorage.getItem("token"),l=N(y.endpoints.productos.list),i=await fetch(l,{method:"GET",headers:{Authorization:`Bearer ${r}`}});if(!i.ok)throw new Error("Error al obtener productos");return(await i.json()).data}catch(r){console.error("Error al obtener productos:",r)}}async function R(r){try{const l=localStorage.getItem("token");return(await fetch(N(y.endpoints.productos.delete(r)),{method:"DELETE",headers:{Authorization:`Bearer ${l}`}})).ok?"✅ Producto eliminado exitosamente":"❌ Error al eliminar el producto"}catch(l){return`Error al obtener productos: 
 ${l}`}}function G(r){return I({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C140.559 48 48 140.559 48 256c0 115.436 92.559 208 208 208 115.435 0 208-92.564 208-208 0-115.441-92.564-208-208-208zm104.002 282.881l-29.12 29.117L256 285.117l-74.881 74.881-29.121-29.117L226.881 256l-74.883-74.881 29.121-29.116L256 226.881l74.881-74.878 29.12 29.116L285.119 256l74.883 74.881z"},child:[]}]})(r)}const O=({onProductAdded:r})=>{const[l,i]=d.useState(!1),[p,m]=d.useState(!1),[u,s]=d.useState(1),[c,f]=d.useState(!1),[w,$]=d.useState([]),[a,h]=d.useState({nombre:"",titulo:"",subtitulo:"",lema:"",descripcion:"",imagen_principal:null,stock:100,precioProducto:199.99,seccion:"Trabajo",especificaciones:{color:"",material:""},dimensiones:{alto:"",largo:"",ancho:""},imagenes:[{url_imagen:null},{url_imagen:null},{url_imagen:null},{url_imagen:null}],relacionados:[]}),x=t=>{h({...a,[t.target.name]:t.target.value})},g=(t,o)=>{h({...a,[o]:{...a[o],[t.target.name]:t.target.value}})},A=t=>{t.target.files&&t.target.files[0]&&h({...a,imagen_principal:t.target.files[0]})},D=(t,o)=>{t.target.checked?h({...a,relacionados:[...a.relacionados,o]}):h({...a,relacionados:a.relacionados.filter(n=>n!==o)})},q=(t,o)=>{if(t.target.files&&t.target.files[0]){const n=[...a.imagenes];n[o]={...n[o],url_imagen:t.target.files[0]},h({...a,imagenes:n})}},b=d.useRef(null);function L(){m(!0)}function C(){s(1),m(!1),h({nombre:"",titulo:"",subtitulo:"",lema:"",descripcion:"",imagen_principal:null,stock:100,precioProducto:199.99,seccion:"Trabajo",especificaciones:{color:"",material:""},dimensiones:{alto:"",largo:"",ancho:""},imagenes:[{url_imagen:null},{url_imagen:null},{url_imagen:null},{url_imagen:null}],relacionados:[]})}function k(){f(!0),setTimeout(()=>{s(t=>t+1),f(!1),P()},500)}function E(){f(!0),setTimeout(()=>{s(t=>t-1),f(!1),P()},500)}function P(){b.current&&b.current.scrollTo({top:0,behavior:"smooth"})}const F=async t=>{if(t.preventDefault(),i(!0),!a.nombre||!a.titulo||!a.subtitulo||!a.lema||!a.descripcion||!a.imagen_principal||!a.seccion||!a.especificaciones.color||!a.especificaciones.material||!a.dimensiones.alto||!a.dimensiones.largo||!a.dimensiones.ancho||!a.imagenes||a.imagenes.some(o=>!o.url_imagen)){alert("⚠️ Todos los campos son obligatorios.");return}try{const o=localStorage.getItem("token"),n=new FormData;n.append("nombre",a.nombre),n.append("titulo",a.titulo),n.append("subtitulo",a.subtitulo),n.append("lema",a.lema),n.append("stock",a.stock.toString()),n.append("precio",a.precioProducto.toString()),n.append("descripcion",a.descripcion),n.append("lema",a.lema),n.append("mensaje_correo",""),n.append("seccion",a.seccion),n.append("especificaciones[color]",a.especificaciones.color),n.append("especificaciones[material]",a.especificaciones.material),n.append("dimensiones[alto]",a.dimensiones.alto+"cm"),n.append("dimensiones[largo]",a.dimensiones.largo+"cm"),n.append("dimensiones[ancho]",a.dimensiones.ancho+"cm"),a.imagenes.forEach((j,v)=>{j.url_imagen&&n.append(`imagenes[${v}][url_imagen]`,j.url_imagen)}),n.append("imagen_principal",a.imagen_principal),a.relacionados.forEach((j,v)=>{n.append(`relacionados[${v}]`,j.toString())});const S=await fetch(N(y.endpoints.productos.create),{method:"POST",body:n,headers:{Authorization:`Bearer ${o}`}}),_=await S.json();console.log("Respuesta del servidor:",_),S.ok?(alert("✅ Producto añadido exitosamente"),C(),i(!1),r?.()):(alert(`❌ Error: ${_.message}`),i(!1))}catch(o){console.error("Error al enviar los datos:",o),alert(`❌ Error: ${o}`),i(!1)}};return d.useEffect(()=>{p&&(async()=>{try{const o=await T();$(o)}catch(o){console.error("Error al obtener productos:",o)}})()},[p]),e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:L,className:"w-full pagination-btn",children:"Agregar Producto"}),p&&e.jsxs("div",{className:"h-screen w-screen bg-black/75 absolute top-0 left-0 z-50 flex justify-center items-center",children:[e.jsx("button",{className:"absolute top-5 right-5 text-red-200 hover:text-red-600 transition-all duration-300 hover:cursor-pointer text-4xl",onClick:()=>C(),children:e.jsx(G,{})}),e.jsxs("div",{ref:b,className:`bg-teal-700 w-1/2 h-10/12 rounded-xl p-10 relative transition-all duration-500 ${u!==1?"overflow-hidden":"overflow-y-scroll"}`,children:[e.jsx("h4",{className:"text-2xl text-center mb-5 font-bold text-white",children:"Agregar Producto"}),e.jsxs("form",{onSubmit:F,className:"relative",children:[e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${c&&u===1?"-translate-x-full opacity-0 pointer-events-none":""} ${!c&&u===1?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Nombre:"}),e.jsx("input",{required:!0,value:a.nombre,onChange:x,type:"text",name:"nombre",placeholder:"Nombre del producto..."})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Descripción:"}),e.jsx("textarea",{required:!0,value:a.descripcion,onChange:x,name:"descripcion",placeholder:"Descripción del producto..."})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Título:"}),e.jsx("input",{required:!0,value:a.titulo,onChange:x,type:"text",name:"titulo",placeholder:"Título..."})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Subtitulo:"}),e.jsx("input",{required:!0,value:a.subtitulo,onChange:x,type:"text",name:"subtitulo",placeholder:"Subtitulo..."})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Lema:"}),e.jsx("input",{required:!0,value:a.lema,onChange:x,type:"text",name:"lema",placeholder:"Lema..."})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Imagen Principal del Producto:"}),e.jsx("input",{required:!0,accept:"image/png, image/jpeg, image/jpg",onChange:A,type:"file",name:"imagen_principal"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Sección del Producto:"}),e.jsxs("select",{required:!0,value:a.seccion,onChange:x,name:"seccion",children:[e.jsx("option",{value:"Trabajo",children:"Trabajo"}),e.jsx("option",{value:"Decoración",children:"Decoración"}),e.jsx("option",{value:"Negocio",children:"Negocio"})]})]}),e.jsxs("div",{className:"group-form",children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Color:"}),e.jsx("input",{required:!0,value:a.especificaciones.color,onChange:t=>g(t,"especificaciones"),name:"color",type:"text"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Material"}),e.jsx("input",{required:!0,value:a.especificaciones.material,onChange:t=>g(t,"especificaciones"),name:"material",type:"text"})]})]}),e.jsxs("div",{className:"group-form",children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Alto:"}),e.jsx("input",{required:!0,value:a.dimensiones.alto,onChange:t=>g(t,"dimensiones"),name:"alto",type:"number",placeholder:"cm"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Ancho"}),e.jsx("input",{required:!0,value:a.dimensiones.ancho,onChange:t=>g(t,"dimensiones"),name:"ancho",type:"number",placeholder:"cm"})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Largo"}),e.jsx("input",{required:!0,value:a.dimensiones.largo,onChange:t=>g(t,"dimensiones"),name:"largo",type:"number",placeholder:"cm"})]})]}),e.jsx("button",{onClick:k,className:"admin-act-btn w-full mb-6",type:"button",children:"Siguiente"})]}),e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${c&&u===2?"-translate-x-full opacity-0 pointer-events-none":""} ${!c&&u===2?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[a.imagenes.map((t,o)=>e.jsxs("div",{className:"form-input",children:[e.jsxs("label",{children:["Imagen ",o+1,":"]}),e.jsx("input",{required:!0,type:"file",accept:"image/*",onChange:n=>q(n,o)})]},o)),e.jsx("button",{type:"button",onClick:k,className:"admin-act-btn w-full",children:"Siguiente"}),e.jsx("button",{onClick:E,className:"neutral-btn w-full mb-6",type:"button",children:"Volver"})]}),e.jsxs("div",{className:`absolute w-full transition-all duration-500 ${c&&u===3?"-translate-x-full opacity-0 pointer-events-none":""} ${!c&&u===3?"translate-x-0 opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{children:"Productos Relacionados:"}),w.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-4 auto-rows-auto overflow-y-scroll h-72 p-2",children:w.map(t=>e.jsx("div",{className:"w-full h-full flex items-center justify-center gap-2",children:e.jsxs("label",{className:"flex flex-col text-white items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"peer hidden",value:t.id,onChange:o=>D(o,t.id)}),e.jsx("img",{src:t.image,alt:t.name,className:"w-36 h-36 rounded-full border-2 border-teal-700 peer-checked:border-slate-900 object-cover"})]})},t.id))}):e.jsx("p",{className:"col-span-3 text-center text-gray-500",children:"Cargando productos..."})]}),e.jsx("button",{onClick:E,className:"neutral-btn w-full mb-6",type:"button",children:"Volver"}),e.jsx("button",{disabled:l,type:"submit",className:`admin-act-btn w-full transition ${l?"disabled:opacity-75 disabled:hover:cursor-not-allowed disabled:cursor-not-allowed disabled:bg-teal-950":""} `,children:l?e.jsxs("span",{className:"w-full text-center flex justify-center items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"})]}),"Guardando..."]}):"Guardar Producto"})]})]})]})]})]})};function H(r){return I({attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"},child:[]}]})(r)}const K=()=>{const[r,l]=d.useState([]),[i,p]=d.useState(null),m=async()=>{const s=await T();s&&l(s)},u=s=>{p(s),R(s).then(c=>{c&&(alert(c),p(null),m())})};return d.useEffect(()=>{m()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"py-4 px-2",children:e.jsx(O,{onProductAdded:m})}),e.jsx("div",{className:"w-full overflow-x-auto overflow-y-scroll",children:e.jsxs("table",{className:"w-full border-separate border-spacing-2",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-teal-600 text-white",children:[e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"ID"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"NOMBRE"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"SECCION"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"IMAGEN PRINCIPAL"}),e.jsx("th",{className:"px-4 py-2 rounded-xl",children:"ACCIÓN"})]})}),e.jsx("tbody",{children:r.map((s,c)=>e.jsxs("tr",{className:`text-center ${c%2===0?"bg-gray-100":"bg-gray-300"}`,children:[e.jsx("td",{className:"px-4 font-bold rounded-xl",children:s.id}),e.jsx("td",{className:"px-4 font-bold rounded-xl",children:s.name}),e.jsx("td",{className:"px-4 font-bold rounded-xl",children:s.seccion}),e.jsx("td",{className:"px-4 font-bold rounded-xl overflow-hidden place-items-center py-2",children:e.jsx("img",{src:s.image,alt:s.name,className:"h-24"})}),e.jsx("td",{className:"px-4 rounded-xl",children:e.jsxs("div",{className:"flex justify-center gap-2 rounded-xl p-1",children:[e.jsx("button",{className:"p-2 text-red-600 hover:text-red-800 transition hover:cursor-pointer",title:"Eliminar",onClick:()=>u(s.id),disabled:i===s.id,children:i===s.id?e.jsx(H,{className:"animate-spin text-red-600",size:18}):e.jsx(M,{size:18})}),e.jsx(B,{})]})})]},s.id))})]})})]})};export{K as default};
